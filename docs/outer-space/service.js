(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();const a="iff-cache",t="./config.json";!function(e){async function n(){let n=new URL(t,e.location.href),i=await(await caches.open(a)).match(n);return await i.json()}async function i(){Promise.all((await e.caches.keys()).filter((e=>e!=a)).map((a=>e.caches.delete(a))))}async function s(){const t=await e.caches.open(a);await t.addAll((await n()).cacheFiles)}e.addEventListener("install",(a=>{e.skipWaiting(),a.waitUntil(s())})),e.addEventListener("activate",(a=>{a.waitUntil(Promise.all([e.clients.claim(),i()]))}));let c=!1;e.onmessage=n=>{"check"===n.data.type&&(c||(c=!0,n.waitUntil(async function(){let n=new BroadcastChannel("iff-update"),i={type:"check",available:!1},o=new URL(t,e.location.href),r=await(await caches.open(a)).match(o),h=await r.json();try{let e=await(await fetch(o,{cache:"no-cache"})).json();e.version>h.version?(await s(),(await caches.open(a)).put(o,new Response(JSON.stringify(e))),i.available=!0,c=!1):c=!1}catch{}n.postMessage(i),n.close(),c=!1}())))},e.addEventListener("fetch",(t=>{t.respondWith((async t=>{let i,s,c=await n(),o=new URL(t.url);if(!0===c.slashIndex&&o.pathname.endsWith("/")?(o.pathname+="index.html",i=await e.caches.match(o,{cacheName:a})):i=await e.caches.match(t,{cacheName:a}),s=i||await fetch(t),!0===c.isolated){let e=new Headers(s.headers);return e.set("Cross-Origin-Opener-Policy","same-origin"),e.set("Cross-Origin-Embedder-Policy","require-corp"),new Response(s.body,{headers:e,status:s.status,statusText:s.statusText})}return s})(t.request))}))}(e.g)})();