/*! For license information please see index.js.LICENSE.txt */
(()=>{var e={197:function(e,t,n){e.exports=function(){"use strict";var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};var t=function(){return t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},t.apply(this,arguments)};function r(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:n.g,i=Object.keys,a=Array.isArray;function s(e,t){return"object"!=typeof t||i(t).forEach((function(n){e[n]=t[n]})),e}"undefined"==typeof Promise||o.Promise||(o.Promise=Promise);var u=Object.getPrototypeOf,c={}.hasOwnProperty;function l(e,t){return c.call(e,t)}function f(e,t){"function"==typeof t&&(t=t(u(e))),("undefined"==typeof Reflect?i:Reflect.ownKeys)(t).forEach((function(n){d(e,n,t[n])}))}var h=Object.defineProperty;function d(e,t,n,r){h(e,t,s(n&&l(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function p(e){return{from:function(t){return e.prototype=Object.create(t.prototype),d(e.prototype,"constructor",e),{extend:f.bind(null,e.prototype)}}}}var y=Object.getOwnPropertyDescriptor;function v(e,t){var n;return y(e,t)||(n=u(e))&&v(n,t)}var m=[].slice;function g(e,t,n){return m.call(e,t,n)}function b(e,t){return t(e)}function w(e){if(!e)throw new Error("Assertion Failed")}function _(e){o.setImmediate?setImmediate(e):setTimeout(e,0)}function x(e,t){if("string"==typeof t&&l(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,o=t.length;r<o;++r){var i=x(e,t[r]);n.push(i)}return n}var a=t.indexOf(".");if(-1!==a){var s=e[t.substr(0,a)];return null==s?void 0:x(s,t.substr(a+1))}}function k(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){w("string"!=typeof n&&"length"in n);for(var r=0,o=t.length;r<o;++r)k(e,t[r],n[r])}else{var i=t.indexOf(".");if(-1!==i){var s=t.substr(0,i),u=t.substr(i+1);if(""===u)void 0===n?a(e)&&!isNaN(parseInt(s))?e.splice(s,1):delete e[s]:e[s]=n;else{var c=e[s];c&&l(e,s)||(c=e[s]={}),k(c,u,n)}}else void 0===n?a(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function $(e){var t={};for(var n in e)l(e,n)&&(t[n]=e[n]);return t}var O=[].concat;function C(e){return O.apply([],e)}var E="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(C([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return o[e]})),P=new Set(E.map((function(e){return o[e]})));function j(e){var t={};for(var n in e)if(l(e,n)){var r=e[n];t[n]=!r||"object"!=typeof r||P.has(r.constructor)?r:j(r)}return t}var S=null;function A(e){S=new WeakMap;var t=K(e);return S=null,t}function K(e){if(!e||"object"!=typeof e)return e;var t=S.get(e);if(t)return t;if(a(e)){t=[],S.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(K(e[n]))}else if(P.has(e.constructor))t=e;else{var o=u(e);for(var i in t=o===Object.prototype?{}:Object.create(o),S.set(e,t),e)l(e,i)&&(t[i]=K(e[i]))}return t}var T={}.toString;function D(e){return T.call(e).slice(8,-1)}var I="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",B="symbol"==typeof I?function(e){var t;return null!=e&&(t=e[I])&&t.apply(e)}:function(){return null};function q(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),n>=0}var R={};function M(e){var t,n,r,o;if(1===arguments.length){if(a(e))return e.slice();if(this===R&&"string"==typeof e)return[e];if(o=B(e)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var N="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},F=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],L=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(F),z={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function U(e,t){this.name=e,this.message=t}function H(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,n){return n.indexOf(e)===t})).join("\n")}function V(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=H(e,t)}function W(e,t){this.name="BulkError",this.failures=Object.keys(t).map((function(e){return t[e]})),this.failuresByPos=t,this.message=H(e,this.failures)}p(U).from(Error).extend({toString:function(){return this.name+": "+this.message}}),p(V).from(U),p(W).from(U);var Y=L.reduce((function(e,t){return e[t]=t+"Error",e}),{}),Q=U,G=L.reduce((function(e,t){var n=t+"Error";function r(e,r){this.name=n,e?"string"==typeof e?(this.message="".concat(e).concat(r?"\n "+r:""),this.inner=r||null):"object"==typeof e&&(this.message="".concat(e.name," ").concat(e.message),this.inner=e):(this.message=z[t]||n,this.inner=null)}return p(r).from(Q),e[t]=r,e}),{});G.Syntax=SyntaxError,G.Type=TypeError,G.Range=RangeError;var X=F.reduce((function(e,t){return e[t+"Error"]=G[t],e}),{});var J=L.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=G[t]),e}),{});function Z(){}function ee(e){return e}function te(e,t){return null==e||e===ee?t:function(n){return t(e(n))}}function ne(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function re(e,t){return e===Z?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?ne(r,this.onsuccess):r),o&&(this.onerror=this.onerror?ne(o,this.onerror):o),void 0!==i?i:n}}function oe(e,t){return e===Z?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?ne(n,this.onsuccess):n),r&&(this.onerror=this.onerror?ne(r,this.onerror):r)}}function ie(e,t){return e===Z?t:function(n){var r=e.apply(this,arguments);s(n,r);var o=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?ne(o,this.onsuccess):o),i&&(this.onerror=this.onerror?ne(i,this.onerror):i),void 0===r?void 0===a?void 0:a:s(r,a)}}function ae(e,t){return e===Z?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function se(e,t){return e===Z?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,o=arguments.length,i=new Array(o);o--;)i[o]=arguments[o];return n.then((function(){return t.apply(r,i)}))}return t.apply(this,arguments)}}J.ModifyError=V,J.DexieError=U,J.BulkError=W;var ue="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ce(e,t){ue=e}var le={},fe=100,he="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,u(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,u(t),e]}(),de=he[0],pe=he[1],ye=he[2],ve=pe&&pe.then,me=de&&de.constructor,ge=!!ye;var be=function(e,t){Ee.push([e,t]),_e&&(queueMicrotask(Re),_e=!1)},we=!0,_e=!0,xe=[],ke=[],$e=ee,Oe={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Z,pgp:!1,env:{},finalize:Z},Ce=Oe,Ee=[],Pe=0,je=[];function Se(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=Ce;if("function"!=typeof e){if(e!==le)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&De(this,this._value))}this._state=null,this._value=null,++t.ref,Te(this,e)}var Ae={get:function(){var e=Ce,t=Ye;function n(n,r){var o=this,i=!e.global&&(e!==Ce||t!==Ye),a=i&&!Je(),s=new Se((function(t,s){Be(o,new Ke(it(n,e,i,a),it(r,e,i,a),t,s,e))}));return this._consoleTask&&(s._consoleTask=this._consoleTask),s}return n.prototype=le,n},set:function(e){d(this,"then",e&&e.prototype===le?Ae:{get:function(){return e},set:Ae.set})}};function Ke(e,t,n,r,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=o}function Te(e,t){try{t((function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Me();t&&"function"==typeof t.then?Te(e,(function(e,n){t instanceof Se?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,Ie(e)),n&&Ne()}}),De.bind(null,e))}catch(t){De(e,t)}}function De(e,t){if(ke.push(t),null===e._state){var n=e._lib&&Me();t=$e(t),e._state=!1,e._value=t,function(e){xe.some((function(t){return t._value===e._value}))||xe.push(e)}(e),Ie(e),n&&Ne()}}function Ie(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Be(e,t[n]);var o=e._PSD;--o.ref||o.finalize(),0===Pe&&(++Pe,be((function(){0==--Pe&&Fe()}),[]))}function Be(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Pe,be(qe,[n,e,t])}else e._listeners.push(t)}function qe(e,t,n){try{var r,o=t._value;!t._state&&ke.length&&(ke=[]),r=ue&&t._consoleTask?t._consoleTask.run((function(){return e(o)})):e(o),t._state||-1!==ke.indexOf(o)||function(e){for(var t=xe.length;t;)if(xe[--t]._value===e._value)return void xe.splice(t,1)}(t),n.resolve(r)}catch(e){n.reject(e)}finally{0==--Pe&&Fe(),--n.psd.ref||n.psd.finalize()}}function Re(){ot(Oe,(function(){Me()&&Ne()}))}function Me(){var e=we;return we=!1,_e=!1,e}function Ne(){var e,t,n;do{for(;Ee.length>0;)for(e=Ee,Ee=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(Ee.length>0);we=!0,_e=!0}function Fe(){var e=xe;xe=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=je.slice(0),n=t.length;n;)t[--n]()}function Le(e){return new Se(le,!1,e)}function ze(e,t){var n=Ce;return function(){var r=Me(),o=Ce;try{return nt(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{nt(o,!1),r&&Ne()}}}f(Se.prototype,{then:Ae,_then:function(e,t){Be(this,new Ke(null,null,e,t,Ce))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,(function(e){return e instanceof t?n(e):Le(e)})):this.then(null,(function(e){return e&&e.name===t?n(e):Le(e)}))},finally:function(e){return this.then((function(t){return Se.resolve(e()).then((function(){return t}))}),(function(t){return Se.resolve(e()).then((function(){return Le(t)}))}))},timeout:function(e,t){var n=this;return e<1/0?new Se((function(r,o){var i=setTimeout((function(){return o(new G.Timeout(t))}),e);n.then(r,o).finally(clearTimeout.bind(null,i))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&d(Se.prototype,Symbol.toStringTag,"Dexie.Promise"),Oe.env=rt(),f(Se,{all:function(){var e=M.apply(null,arguments).map(Ze);return new Se((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach((function(o,i){return Se.resolve(o).then((function(n){e[i]=n,--r||t(e)}),n)}))}))},resolve:function(e){return e instanceof Se?e:e&&"function"==typeof e.then?new Se((function(t,n){e.then(t,n)})):new Se(le,!0,e)},reject:Le,race:function(){var e=M.apply(null,arguments).map(Ze);return new Se((function(t,n){e.map((function(e){return Se.resolve(e).then(t,n)}))}))},PSD:{get:function(){return Ce},set:function(e){return Ce=e}},totalEchoes:{get:function(){return Ye}},newPSD:Ge,usePSD:ot,scheduler:{get:function(){return be},set:function(e){be=e}},rejectionMapper:{get:function(){return $e},set:function(e){$e=e}},follow:function(e,t){return new Se((function(n,r){return Ge((function(t,n){var r=Ce;r.unhandleds=[],r.onunhandled=n,r.finalize=ne((function(){var e=this;!function(e){je.push((function t(){e(),je.splice(je.indexOf(t),1)})),++Pe,be((function(){0==--Pe&&Fe()}),[])}((function(){0===e.unhandleds.length?t():n(e.unhandleds[0])}))}),r.finalize),e()}),t,n,r)}))}}),me&&(me.allSettled&&d(Se,"allSettled",(function(){var e=M.apply(null,arguments).map(Ze);return new Se((function(t){0===e.length&&t([]);var n=e.length,r=new Array(n);e.forEach((function(e,o){return Se.resolve(e).then((function(e){return r[o]={status:"fulfilled",value:e}}),(function(e){return r[o]={status:"rejected",reason:e}})).then((function(){return--n||t(r)}))}))}))})),me.any&&"undefined"!=typeof AggregateError&&d(Se,"any",(function(){var e=M.apply(null,arguments).map(Ze);return new Se((function(t,n){0===e.length&&n(new AggregateError([]));var r=e.length,o=new Array(r);e.forEach((function(e,i){return Se.resolve(e).then((function(e){return t(e)}),(function(e){o[i]=e,--r||n(new AggregateError(o))}))}))}))})));var Ue={awaits:0,echoes:0,id:0},He=0,Ve=[],We=0,Ye=0,Qe=0;function Ge(e,t,n,r){var o=Ce,i=Object.create(o);i.parent=o,i.ref=0,i.global=!1,i.id=++Qe,Oe.env,i.env=ge?{Promise:Se,PromiseProp:{value:Se,configurable:!0,writable:!0},all:Se.all,race:Se.race,allSettled:Se.allSettled,any:Se.any,resolve:Se.resolve,reject:Se.reject}:{},t&&s(i,t),++o.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=ot(i,e,n,r);return 0===i.ref&&i.finalize(),a}function Xe(){return Ue.id||(Ue.id=++He),++Ue.awaits,Ue.echoes+=fe,Ue.id}function Je(){return!!Ue.awaits&&(0==--Ue.awaits&&(Ue.id=0),Ue.echoes=Ue.awaits*fe,!0)}function Ze(e){return Ue.echoes&&e&&e.constructor===me?(Xe(),e.then((function(e){return Je(),e}),(function(e){return Je(),st(e)}))):e}function et(e){++Ye,Ue.echoes&&0!=--Ue.echoes||(Ue.echoes=Ue.awaits=Ue.id=0),Ve.push(Ce),nt(e,!0)}function tt(){var e=Ve[Ve.length-1];Ve.pop(),nt(e,!1)}function nt(e,t){var n=Ce;if((t?!Ue.echoes||We++&&e===Ce:!We||--We&&e===Ce)||queueMicrotask(t?et.bind(null,e):tt),e!==Ce&&(Ce=e,n===Oe&&(Oe.env=rt()),ge)){var r=Oe.env.Promise,i=e.env;(n.global||e.global)&&(Object.defineProperty(o,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function rt(){var e=o.Promise;return ge?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function ot(e,t,n,r,o){var i=Ce;try{return nt(e,!0),t(n,r,o)}finally{nt(i,!1)}}function it(e,t,n,r){return"function"!=typeof e?e:function(){var o=Ce;n&&Xe(),nt(t,!0);try{return e.apply(this,arguments)}finally{nt(o,!1),r&&queueMicrotask(Je)}}}function at(e){Promise===me&&0===Ue.echoes?0===We?e():enqueueNativeMicroTask(e):setTimeout(e,0)}-1===(""+ve).indexOf("[native code]")&&(Xe=Je=Z);var st=Se.reject;function ut(e,t,n,r){if(e.idbdb&&(e._state.openComplete||Ce.letThrough||e._vip)){var o=e._createTransaction(t,n,e._dbSchema);try{o.create(),e._state.PR1398_maxLoop=3}catch(o){return o.name===Y.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then((function(){return ut(e,t,n,r)}))):st(o)}return o._promise(t,(function(e,t){return Ge((function(){return Ce.trans=o,r(e,t,o)}))})).then((function(e){if("readwrite"===t)try{o.idbtrans.commit()}catch(e){}return"readonly"===t?e:o._completion.then((function(){return e}))}))}if(e._state.openComplete)return st(new G.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return st(new G.DatabaseClosed);e.open().catch(Z)}return e._state.dbReadyPromise.then((function(){return ut(e,t,n,r)}))}var ct="4.0.4",lt=String.fromCharCode(65535),ft=-1/0,ht="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",dt="String expected.",pt=[],yt="__dbnames",vt="readonly",mt="readwrite";function gt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var bt={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function wt(e){return"string"!=typeof e||/\./.test(e)?function(e){return e}:function(t){return void 0===t[e]&&e in t&&delete(t=A(t))[e],t}}function _t(){throw G.Type()}function xt(e,t){try{var n=kt(e),r=kt(t);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(e,t){for(var n=e.length,r=t.length,o=n<r?n:r,i=0;i<o;++i)if(e[i]!==t[i])return e[i]<t[i]?-1:1;return n===r?0:n<r?-1:1}($t(e),$t(t));case"Array":return function(e,t){for(var n=e.length,r=t.length,o=n<r?n:r,i=0;i<o;++i){var a=xt(e[i],t[i]);if(0!==a)return a}return n===r?0:n<r?-1:1}(e,t)}}catch(e){}return NaN}function kt(e){var t=typeof e;if("object"!==t)return t;if(ArrayBuffer.isView(e))return"binary";var n=D(e);return"ArrayBuffer"===n?"binary":n}function $t(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var Ot=function(){function t(){}return t.prototype._trans=function(e,t,n){var r=this._tx||Ce.trans,o=this.name,i=ue&&"undefined"!=typeof console&&console.createTask&&console.createTask("Dexie: ".concat("readonly"===e?"read":"write"," ").concat(this.name));function a(e,n,r){if(!r.schema[o])throw new G.NotFound("Table "+o+" not part of transaction");return t(r.idbtrans,r)}var s=Me();try{var u=r&&r.db._novip===this.db._novip?r===Ce.trans?r._promise(e,a,n):Ge((function(){return r._promise(e,a,n)}),{trans:r,transless:Ce.transless||Ce}):ut(this.db,e,[this.name],a);return i&&(u._consoleTask=i,u=u.catch((function(e){return console.trace(e),st(e)}))),u}finally{s&&Ne()}},t.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):null==e?st(new G.Type("Invalid argument to Table.get()")):this._trans("readonly",(function(t){return n.core.get({trans:t,key:e}).then((function(e){return n.hook.reading.fire(e)}))})).then(t)},t.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(a(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=i(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter((function(e){if(e.compound&&t.every((function(t){return e.keyPath.indexOf(t)>=0}))){for(var n=0;n<t.length;++n)if(-1===t.indexOf(e.keyPath[n]))return!1;return!0}return!1})).sort((function(e,t){return e.keyPath.length-t.keyPath.length}))[0];if(n&&this.db._maxKey!==lt){var r=n.keyPath.slice(0,t.length);return this.where(r).equals(r.map((function(t){return e[t]})))}!n&&ue&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var o=this.schema.idxByName,s=this.db._deps.indexedDB;function u(e,t){return 0===s.cmp(e,t)}var c=t.reduce((function(t,n){var r=t[0],i=t[1],s=o[n],c=e[n];return[r||s,r||!s?gt(i,s&&s.multi?function(e){var t=x(e,n);return a(t)&&t.some((function(e){return u(c,e)}))}:function(e){return u(c,x(e,n))}):i]}),[null,null]),l=c[0],f=c[1];return l?this.where(l.name).equals(e[l.keyPath]).filter(f):n?this.filter(f):this.where(t).equals("")},t.prototype.filter=function(e){return this.toCollection().and(e)},t.prototype.count=function(e){return this.toCollection().count(e)},t.prototype.offset=function(e){return this.toCollection().offset(e)},t.prototype.limit=function(e){return this.toCollection().limit(e)},t.prototype.each=function(e){return this.toCollection().each(e)},t.prototype.toArray=function(e){return this.toCollection().toArray(e)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,a(e)?"[".concat(e.join("+"),"]"):e))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(t){var n=this.db,r=this.name;this.schema.mappedClass=t,t.prototype instanceof _t&&(t=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}(o,t),Object.defineProperty(o.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),o.prototype.table=function(){return r},o}(t));for(var o=new Set,i=t.prototype;i;i=u(i))Object.getOwnPropertyNames(i).forEach((function(e){return o.add(e)}));var a=function(e){if(!e)return e;var n=Object.create(t.prototype);for(var r in e)if(!o.has(r))try{n[r]=e[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=a,this.hook("reading",a),t},t.prototype.defineClass=function(){return this.mapToClass((function(e){s(this,e)}))},t.prototype.add=function(e,t){var n=this,r=this.schema.primKey,o=r.auto,i=r.keyPath,a=e;return i&&o&&(a=wt(i)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[a]})})).then((function(e){return e.numFailures?Se.reject(e.failures[0]):e.lastResult})).then((function(t){if(i)try{k(e,i,t)}catch(e){}return t}))},t.prototype.update=function(e,t){if("object"!=typeof e||a(e))return this.where(":id").equals(e).modify(t);var n=x(e,this.schema.primKey.keyPath);return void 0===n?st(new G.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(t)},t.prototype.put=function(e,t){var n=this,r=this.schema.primKey,o=r.auto,i=r.keyPath,a=e;return i&&o&&(a=wt(i)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"put",values:[a],keys:null!=t?[t]:null})})).then((function(e){return e.numFailures?Se.reject(e.failures[0]):e.lastResult})).then((function(t){if(i)try{k(e,i,t)}catch(e){}return t}))},t.prototype.delete=function(e){var t=this;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?Se.reject(e.failures[0]):void 0}))},t.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:bt})})).then((function(e){return e.numFailures?Se.reject(e.failures[0]):void 0}))},t.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(n){return t.core.getMany({keys:e,trans:n}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))},t.prototype.bulkAdd=function(e,t,n){var r=this,o=Array.isArray(t)?t:void 0,i=(n=n||(o?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=r.schema.primKey,a=n.auto,s=n.keyPath;if(s&&o)throw new G.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new G.InvalidArgument("Arguments objects and keys must have the same length");var u=e.length,c=s&&a?e.map(wt(s)):e;return r.core.mutate({trans:t,type:"add",keys:o,values:c,wantResults:i}).then((function(e){var t=e.numFailures,n=e.results,o=e.lastResult,a=e.failures;if(0===t)return i?n:o;throw new W("".concat(r.name,".bulkAdd(): ").concat(t," of ").concat(u," operations failed"),a)}))}))},t.prototype.bulkPut=function(e,t,n){var r=this,o=Array.isArray(t)?t:void 0,i=(n=n||(o?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=r.schema.primKey,a=n.auto,s=n.keyPath;if(s&&o)throw new G.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new G.InvalidArgument("Arguments objects and keys must have the same length");var u=e.length,c=s&&a?e.map(wt(s)):e;return r.core.mutate({trans:t,type:"put",keys:o,values:c,wantResults:i}).then((function(e){var t=e.numFailures,n=e.results,o=e.lastResult,a=e.failures;if(0===t)return i?n:o;throw new W("".concat(r.name,".bulkPut(): ").concat(t," of ").concat(u," operations failed"),a)}))}))},t.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map((function(e){return e.key})),o=e.map((function(e){return e.changes})),i=[];return this._trans("readwrite",(function(a){return n.getMany({trans:a,keys:r,cache:"clone"}).then((function(s){var u=[],c=[];e.forEach((function(e,n){var r=e.key,o=e.changes,a=s[n];if(a){for(var l=0,f=Object.keys(o);l<f.length;l++){var h=f[l],d=o[h];if(h===t.schema.primKey.keyPath){if(0!==xt(d,r))throw new G.Constraint("Cannot update primary key in bulkUpdate()")}else k(a,h,d)}i.push(n),u.push(r),c.push(a)}}));var l=u.length;return n.mutate({trans:a,type:"put",keys:u,values:c,updates:{keys:r,changeSpecs:o}}).then((function(e){var n=e.numFailures,r=e.failures;if(0===n)return l;for(var o=0,a=Object.keys(r);o<a.length;o++){var s=a[o],u=i[Number(s)];if(null!=u){var c=r[s];delete r[s],r[u]=c}}throw new W("".concat(t.name,".bulkUpdate(): ").concat(n," of ").concat(l," operations failed"),r)}))}))}))},t.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:e})})).then((function(e){var r=e.numFailures,o=e.lastResult,i=e.failures;if(0===r)return o;throw new W("".concat(t.name,".bulkDelete(): ").concat(r," of ").concat(n," operations failed"),i)}))},t}();function Ct(e){var t={},n=function(n,r){if(r){for(var o=arguments.length,i=new Array(o-1);--o;)i[o-1]=arguments[o];return t[n].subscribe.apply(null,i),e}if("string"==typeof n)return t[n]};n.addEventType=s;for(var r=1,o=arguments.length;r<o;++r)s(arguments[r]);return n;function s(e,r,o){if("object"!=typeof e){var u;r||(r=ae),o||(o=Z);var c={subscribers:[],fire:o,subscribe:function(e){-1===c.subscribers.indexOf(e)&&(c.subscribers.push(e),c.fire=r(c.fire,e))},unsubscribe:function(e){c.subscribers=c.subscribers.filter((function(t){return t!==e})),c.fire=c.subscribers.reduce(r,o)}};return t[e]=n[e]=c,c}i(u=e).forEach((function(e){var t=u[e];if(a(t))s(e,u[e][0],u[e][1]);else{if("asap"!==t)throw new G.InvalidArgument("Invalid event config");var n=s(e,ee,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];n.subscribers.forEach((function(e){_((function(){e.apply(null,t)}))}))}))}}))}}function Et(e,t){return p(t).from({prototype:e}),t}function Pt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function jt(e,t){e.filter=gt(e.filter,t)}function St(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return gt(r(),t())}:t,e.justLimit=n&&!r}function At(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new G.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Kt(e,t,n){var r=At(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function Tt(e,t,n,r){var o=e.replayFilter?gt(e.filter,e.replayFilter()):e.filter;if(e.or){var i={},a=function(e,n,r){if(!o||o(n,r,(function(e){return n.stop(e)}),(function(e){return n.fail(e)}))){var a=n.primaryKey,s=""+a;"[object ArrayBuffer]"===s&&(s=""+new Uint8Array(a)),l(i,s)||(i[s]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(a,n),Dt(Kt(e,r,n),e.algorithm,a,!e.keysOnly&&e.valueMapper)])}return Dt(Kt(e,r,n),gt(e.algorithm,o),t,!e.keysOnly&&e.valueMapper)}function Dt(e,t,n,r){var o=ze(r?function(e,t,o){return n(r(e),t,o)}:n);return e.then((function(e){if(e)return e.start((function(){var n=function(){return e.continue()};t&&!t(e,(function(e){return n=e}),(function(t){e.stop(t),n=Z}),(function(t){e.fail(t),n=Z}))||o(e.value,e,(function(e){return n=e})),n()}))}))}var It=Symbol(),Bt=function(){function e(e){Object.assign(this,e)}return e.prototype.execute=function(e){var t,n=null===(t=this.replacePrefix)||void 0===t?void 0:t[0];return n&&"string"==typeof e&&e.startsWith(n)?this.replacePrefix[1]+e.substring(n.length):e},e}(),qt=function(){function e(){}return e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,st.bind(null,n.error)):n.table._trans("readonly",e).then(t)},e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,st.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=gt(t.algorithm,e)},e.prototype._iterate=function(e,t){return Tt(this._ctx,e,t,this._ctx.table.core)},e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&s(n,e),t._ctx=n,t},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var t=this._ctx;return this._read((function(n){return Tt(t,e,n,t.table.core)}))},e.prototype.count=function(e){var t=this;return this._read((function(e){var n=t._ctx,r=n.table.core;if(Pt(n,!0))return r.count({trans:e,query:{index:At(n,r.schema),range:n.range}}).then((function(e){return Math.min(e,n.limit)}));var o=0;return Tt(n,(function(){return++o,!1}),e,r).then((function(){return o}))})).then(e)},e.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],o=n.length-1;function i(e,t){return t?i(e[n[t]],t-1):e[r]}var a="next"===this._ctx.dir?1:-1;function s(e,t){var n=i(e,o),r=i(t,o);return n<r?-a:n>r?a:0}return this.toArray((function(e){return e.sort(s)})).then(t)},e.prototype.toArray=function(e){var t=this;return this._read((function(e){var n=t._ctx;if("next"===n.dir&&Pt(n,!0)&&n.limit>0){var r=n.valueMapper,o=At(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:o,range:n.range}}).then((function(e){var t=e.result;return r?t.map(r):t}))}var i=[];return Tt(n,(function(e){return i.push(e)}),e,n.table.core).then((function(){return i}))}),e)},e.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Pt(t)?St(t,(function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n((function(){e.advance(t),t=0})),!1))}})):St(t,(function(){var t=e;return function(){return--t<0}}))),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),St(this._ctx,(function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this},e.prototype.until=function(e,t){return jt(this._ctx,(function(n,r,o){return!e(n.value)||(r(o),t)})),this},e.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){return jt(this._ctx,(function(t){return e(t.value)})),t=this._ctx,n=e,t.isMatch=gt(t.isMatch,n),this;var t,n},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))},e.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)},e.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&Pt(t,!0)&&t.limit>0)return this._read((function(e){var n=At(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((function(e){return e.result})).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return jt(this._ctx,(function(e){var t=e.primaryKey.toString(),r=l(n,t);return n[t]=!0,!r})),this},e.prototype.modify=function(e){var t=this,n=this._ctx;return this._write((function(r){var o;if("function"==typeof e)o=e;else{var a=i(e),s=a.length;o=function(t){for(var n=!1,r=0;r<s;++r){var o=a[r],i=e[o],u=x(t,o);i instanceof Bt?(k(t,o,i.execute(u)),n=!0):u!==i&&(k(t,o,i),n=!0)}return n}}var u=n.table.core,c=u.schema.primaryKey,l=c.outbound,f=c.extractKey,h=t.db._options.modifyChunkSize||200,d=[],p=0,y=[],v=function(e,t){var n=t.failures,r=t.numFailures;p+=e-r;for(var o=0,a=i(n);o<a.length;o++){var s=a[o];d.push(n[s])}};return t.clone().primaryKeys().then((function(t){var i=function(a){var s=Math.min(h,t.length-a);return u.getMany({trans:r,keys:t.slice(a,a+s),cache:"immutable"}).then((function(c){for(var d=[],p=[],y=l?[]:null,m=[],g=0;g<s;++g){var b=c[g],w={value:A(b),primKey:t[a+g]};!1!==o.call(w,w.value,w)&&(null==w.value?m.push(t[a+g]):l||0===xt(f(b),f(w.value))?(p.push(w.value),l&&y.push(t[a+g])):(m.push(t[a+g]),d.push(w.value)))}var _=Pt(n)&&n.limit===1/0&&("function"!=typeof e||e===Rt)&&{index:n.index,range:n.range};return Promise.resolve(d.length>0&&u.mutate({trans:r,type:"add",values:d}).then((function(e){for(var t in e.failures)m.splice(parseInt(t),1);v(d.length,e)}))).then((function(){return(p.length>0||_&&"object"==typeof e)&&u.mutate({trans:r,type:"put",keys:y,values:p,criteria:_,changeSpec:"function"!=typeof e&&e}).then((function(e){return v(p.length,e)}))})).then((function(){return(m.length>0||_&&e===Rt)&&u.mutate({trans:r,type:"delete",keys:m,criteria:_}).then((function(e){return v(m.length,e)}))})).then((function(){return t.length>a+s&&i(a+h)}))}))};return i(0).then((function(){if(d.length>0)throw new V("Error modifying one or more objects",d,p,y);return t.length}))}))}))},e.prototype.delete=function(){var e=this._ctx,t=e.range;return Pt(e)&&(e.isPrimKey||3===t.type)?this._write((function(n){var r=e.table.core.schema.primaryKey,o=t;return e.table.core.count({trans:n,query:{index:r,range:o}}).then((function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:o}).then((function(e){var n=e.failures;e.lastResult,e.results;var r=e.numFailures;if(r)throw new V("Could not delete some values",Object.keys(n).map((function(e){return n[e]})),t-r);return t-r}))}))})):this.modify(Rt)},e}(),Rt=function(e,t){return t.value=null};function Mt(e,t){return e<t?-1:e===t?0:1}function Nt(e,t){return e>t?-1:e===t?0:1}function Ft(e,t,n){var r=e instanceof Wt?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function Lt(e){return new e.Collection(e,(function(){return Vt("")})).limit(0)}function zt(e,t,n,r,o,i){for(var a=Math.min(e.length,r.length),s=-1,u=0;u<a;++u){var c=t[u];if(c!==r[u])return o(e[u],n[u])<0?e.substr(0,u)+n[u]+n.substr(u+1):o(e[u],r[u])<0?e.substr(0,u)+r[u]+n.substr(u+1):s>=0?e.substr(0,s)+t[s]+n.substr(s+1):null;o(e[u],c)<0&&(s=u)}return a<r.length&&"next"===i?e+n.substr(e.length):a<e.length&&"prev"===i?e.substr(0,n.length):s<0?null:e.substr(0,s)+r[s]+n.substr(s+1)}function Ut(e,t,n,r){var o,i,a,s,u,c,l,f=n.length;if(!n.every((function(e){return"string"==typeof e})))return Ft(e,dt);function h(e){o=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),i=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),a="next"===e?Mt:Nt;var t=n.map((function(e){return{lower:i(e),upper:o(e)}})).sort((function(e,t){return a(e.lower,t.lower)}));s=t.map((function(e){return e.upper})),u=t.map((function(e){return e.lower})),c=e,l="next"===e?"":r}h("next");var d=new e.Collection(e,(function(){return Ht(s[0],u[f-1]+r)}));d._ondirectionchange=function(e){h(e)};var p=0;return d._addAlgorithm((function(e,n,r){var o=e.key;if("string"!=typeof o)return!1;var h=i(o);if(t(h,u,p))return!0;for(var d=null,y=p;y<f;++y){var v=zt(o,h,s[y],u[y],a,c);null===v&&null===d?p=y+1:(null===d||a(d,v)>0)&&(d=v)}return n(null!==d?function(){e.continue(d+l)}:r),!1})),d}function Ht(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Vt(e){return{type:1,lower:e,upper:e}}var Wt=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?Lt(this):new this.Collection(this,(function(){return Ht(e,t,!n,!r)}))}catch(e){return Ft(this,ht)}},e.prototype.equals=function(e){return null==e?Ft(this,ht):new this.Collection(this,(function(){return Vt(e)}))},e.prototype.above=function(e){return null==e?Ft(this,ht):new this.Collection(this,(function(){return Ht(e,void 0,!0)}))},e.prototype.aboveOrEqual=function(e){return null==e?Ft(this,ht):new this.Collection(this,(function(){return Ht(e,void 0,!1)}))},e.prototype.below=function(e){return null==e?Ft(this,ht):new this.Collection(this,(function(){return Ht(void 0,e,!1,!0)}))},e.prototype.belowOrEqual=function(e){return null==e?Ft(this,ht):new this.Collection(this,(function(){return Ht(void 0,e)}))},e.prototype.startsWith=function(e){return"string"!=typeof e?Ft(this,dt):this.between(e,e+lt,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):Ut(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],lt)},e.prototype.equalsIgnoreCase=function(e){return Ut(this,(function(e,t){return e===t[0]}),[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=M.apply(R,arguments);return 0===e.length?Lt(this):Ut(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=M.apply(R,arguments);return 0===e.length?Lt(this):Ut(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,lt)},e.prototype.anyOf=function(){var e=this,t=M.apply(R,arguments),n=this._cmp;try{t.sort(n)}catch(e){return Ft(this,ht)}if(0===t.length)return Lt(this);var r=new this.Collection(this,(function(){return Ht(t[0],t[t.length-1])}));r._ondirectionchange=function(r){n="next"===r?e._ascending:e._descending,t.sort(n)};var o=0;return r._addAlgorithm((function(e,r,i){for(var a=e.key;n(a,t[o])>0;)if(++o===t.length)return r(i),!1;return 0===n(a,t[o])||(r((function(){e.continue(t[o])})),!1)})),r},e.prototype.notEqual=function(e){return this.inAnyRange([[ft,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=M.apply(R,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return Ft(this,ht)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[ft,t]]}),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,o=this._ascending,i=this._descending,a=this._min,s=this._max;if(0===e.length)return Lt(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&o(e[0],e[1])<=0})))return Ft(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",G.InvalidArgument);var u=!t||!1!==t.includeLowers,c=t&&!0===t.includeUppers;var l,f=o;function h(e,t){return f(e[0],t[0])}try{(l=e.reduce((function(e,t){for(var n=0,o=e.length;n<o;++n){var i=e[n];if(r(t[0],i[1])<0&&r(t[1],i[0])>0){i[0]=a(i[0],t[0]),i[1]=s(i[1],t[1]);break}}return n===o&&e.push(t),e}),[])).sort(h)}catch(e){return Ft(this,ht)}var d=0,p=c?function(e){return o(e,l[d][1])>0}:function(e){return o(e,l[d][1])>=0},y=u?function(e){return i(e,l[d][0])>0}:function(e){return i(e,l[d][0])>=0};var v=p,m=new this.Collection(this,(function(){return Ht(l[0][0],l[l.length-1][1],!u,!c)}));return m._ondirectionchange=function(e){"next"===e?(v=p,f=o):(v=y,f=i),l.sort(h)},m._addAlgorithm((function(e,t,r){for(var i=e.key;v(i);)if(++d===l.length)return t(r),!1;return!!function(e){return!p(e)&&!y(e)}(i)||(0===n._cmp(i,l[d][1])||0===n._cmp(i,l[d][0])||t((function(){f===o?e.continue(l[d][0]):e.continue(l[d][1])})),!1)})),m},e.prototype.startsWithAnyOf=function(){var e=M.apply(R,arguments);return e.every((function(e){return"string"==typeof e}))?0===e.length?Lt(this):this.inAnyRange(e.map((function(e){return[e,e+lt]}))):Ft(this,"startsWithAnyOf() only works with strings")},e}();function Yt(e){return ze((function(t){return Qt(t),e(t.target.error),!1}))}function Qt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Gt="storagemutated",Xt="x-storagemutated-1",Jt=Ct(null,Gt),Zt=function(){function e(){}return e.prototype._lock=function(){return w(!Ce.global),++this._reculock,1!==this._reculock||Ce.global||(Ce.lockOwnerFor=this),this},e.prototype._unlock=function(){if(w(!Ce.global),0==--this._reculock)for(Ce.global||(Ce.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{ot(e[1],e[0])}catch(e){}}return this},e.prototype._locked=function(){return this._reculock&&Ce.lockOwnerFor!==this},e.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(w(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new G.DatabaseClosed(r);case"MissingAPIError":throw new G.MissingAPI(r.message,r);default:throw new G.OpenFailed(r)}if(!this.active)throw new G.TransactionInactive;return w(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=ze((function(n){Qt(n),t._reject(e.error)})),e.onabort=ze((function(n){Qt(n),t.active&&t._reject(new G.Abort(e.error)),t.active=!1,t.on("abort").fire(n)})),e.oncomplete=ze((function(){t.active=!1,t._resolve(),"mutatedParts"in e&&Jt.storagemutated.fire(e.mutatedParts)})),this},e.prototype._promise=function(e,t,n){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return st(new G.ReadOnly("Transaction is readonly"));if(!this.active)return st(new G.TransactionInactive);if(this._locked())return new Se((function(o,i){r._blockedFuncs.push([function(){r._promise(e,t,n).then(o,i)},Ce])}));if(n)return Ge((function(){var e=new Se((function(e,n){r._lock();var o=t(e,n,r);o&&o.then&&o.then(e,n)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var o=new Se((function(e,n){var o=t(e,n,r);o&&o.then&&o.then(e,n)}));return o._lib=!0,o},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var t=this._root(),n=Se.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((function(){return n}));else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var o=t._waitingFor;return new Se((function(e,r){n.then((function(n){return t._waitingQueue.push(ze(e.bind(null,n)))}),(function(e){return t._waitingQueue.push(ze(r.bind(null,e)))})).finally((function(){t._waitingFor===o&&(t._waitingFor=null)}))}))},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new G.Abort))},e.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(l(t,e))return t[e];var n=this.schema[e];if(!n)throw new G.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r},e}();function en(e,t,n,r,o,i,a){return{name:e,keyPath:t,unique:n,multi:r,auto:o,compound:i,src:(n&&!a?"&":"")+(r?"*":"")+(o?"++":"")+tn(t)}}function tn(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function nn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(r=n,o=function(e){return[e.name,e]},r.reduce((function(e,t,n){var r=o(t,n);return r&&(e[r[0]]=r[1]),e}),{}))};var r,o}var rn=function(e){try{return e.only([[]]),rn=function(){return[[]]},[[]]}catch(e){return rn=function(){return lt},lt}};function on(e){return null==e?function(){}:"string"==typeof e?function(e){return 1===e.split(".").length?function(t){return t[e]}:function(t){return x(t,e)}}(e):function(t){return x(t,e)}}function an(e){return[].slice.call(e)}var sn=0;function un(e){return null==e?":id":"string"==typeof e?e:"[".concat(e.join("+"),"]")}function cn(e,t,n){function r(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var n=e.lower,r=e.upper,o=e.lowerOpen,i=e.upperOpen;return void 0===n?void 0===r?null:t.upperBound(r,!!i):void 0===r?t.lowerBound(n,!!o):t.bound(n,r,!!o,!!i)}var o=function(e,t){var n=an(e.objectStoreNames);return{schema:{name:e.name,tables:n.map((function(e){return t.objectStore(e)})).map((function(e){var t=e.keyPath,n=e.autoIncrement,r=a(t),o=null==t,i={},s={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:o,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:on(t)},indexes:an(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,n=e.unique,r=e.multiEntry,o=e.keyPath,s={name:t,compound:a(o),keyPath:o,unique:n,multiEntry:r,extractKey:on(o)};return i[un(o)]=s,s})),getIndexByKeyPath:function(e){return i[un(e)]}};return i[":id"]=s.primaryKey,null!=t&&(i[un(t)]=s.primaryKey),s}))},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,n),i=o.schema,s=o.hasGetAll,u=i.tables.map((function(e){return function(e){var t=e.name;return{name:t,schema:e,mutate:function(e){var n=e.trans,o=e.type,i=e.keys,a=e.values,s=e.range;return new Promise((function(e,u){e=ze(e);var c=n.objectStore(t),l=null==c.keyPath,f="put"===o||"add"===o;if(!f&&"delete"!==o&&"deleteRange"!==o)throw new Error("Invalid operation type: "+o);var h,d=(i||a||{length:1}).length;if(i&&a&&i.length!==a.length)throw new Error("Given keys array must have same length as given values array.");if(0===d)return e({numFailures:0,failures:{},results:[],lastResult:void 0});var p=[],y=[],v=0,m=function(e){++v,Qt(e)};if("deleteRange"===o){if(4===s.type)return e({numFailures:v,failures:y,results:[],lastResult:void 0});3===s.type?p.push(h=c.clear()):p.push(h=c.delete(r(s)))}else{var g=f?l?[a,i]:[a,null]:[i,null],b=g[0],w=g[1];if(f)for(var _=0;_<d;++_)p.push(h=w&&void 0!==w[_]?c[o](b[_],w[_]):c[o](b[_])),h.onerror=m;else for(_=0;_<d;++_)p.push(h=c[o](b[_])),h.onerror=m}var x=function(t){var n=t.target.result;p.forEach((function(e,t){return null!=e.error&&(y[t]=e.error)})),e({numFailures:v,failures:y,results:"delete"===o?i:p.map((function(e){return e.result})),lastResult:n})};h.onerror=function(e){m(e),x(e)},h.onsuccess=x}))},getMany:function(e){var n=e.trans,r=e.keys;return new Promise((function(e,o){e=ze(e);for(var i,a=n.objectStore(t),s=r.length,u=new Array(s),c=0,l=0,f=function(t){var n=t.target;u[n._pos]=n.result,++l===c&&e(u)},h=Yt(o),d=0;d<s;++d)null!=r[d]&&((i=a.get(r[d]))._pos=d,i.onsuccess=f,i.onerror=h,++c);0===c&&e(u)}))},get:function(e){var n=e.trans,r=e.key;return new Promise((function(e,o){e=ze(e);var i=n.objectStore(t).get(r);i.onsuccess=function(t){return e(t.target.result)},i.onerror=Yt(o)}))},query:function(e){return function(n){return new Promise((function(o,i){o=ze(o);var a=n.trans,s=n.values,u=n.limit,c=n.query,l=u===1/0?void 0:u,f=c.index,h=c.range,d=a.objectStore(t),p=f.isPrimaryKey?d:d.index(f.name),y=r(h);if(0===u)return o({result:[]});if(e){var v=s?p.getAll(y,l):p.getAllKeys(y,l);v.onsuccess=function(e){return o({result:e.target.result})},v.onerror=Yt(i)}else{var m=0,g=s||!("openKeyCursor"in p)?p.openCursor(y):p.openKeyCursor(y),b=[];g.onsuccess=function(e){var t=g.result;return t?(b.push(s?t.value:t.primaryKey),++m===u?o({result:b}):void t.continue()):o({result:b})},g.onerror=Yt(i)}}))}}(s),openCursor:function(e){var n=e.trans,o=e.values,i=e.query,a=e.reverse,s=e.unique;return new Promise((function(e,u){e=ze(e);var c=i.index,l=i.range,f=n.objectStore(t),h=c.isPrimaryKey?f:f.index(c.name),d=a?s?"prevunique":"prev":s?"nextunique":"next",p=o||!("openKeyCursor"in h)?h.openCursor(r(l),d):h.openKeyCursor(r(l),d);p.onerror=Yt(u),p.onsuccess=ze((function(t){var r=p.result;if(r){r.___id=++sn,r.done=!1;var o=r.continue.bind(r),i=r.continuePrimaryKey;i&&(i=i.bind(r));var a=r.advance.bind(r),s=function(){throw new Error("Cursor not stopped")};r.trans=n,r.stop=r.continue=r.continuePrimaryKey=r.advance=function(){throw new Error("Cursor not started")},r.fail=ze(u),r.next=function(){var e=this,t=1;return this.start((function(){return t--?e.continue():e.stop()})).then((function(){return e}))},r.start=function(e){var t=new Promise((function(e,t){e=ze(e),p.onerror=Yt(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=s,e(t)}})),n=function(){if(p.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return p.onsuccess=ze((function(e){p.onsuccess=n,n()})),r.continue=o,r.continuePrimaryKey=i,r.advance=a,n(),t},e(r)}else e(null)}),u)}))},count:function(e){var n=e.query,o=e.trans,i=n.index,a=n.range;return new Promise((function(e,n){var s=o.objectStore(t),u=i.isPrimaryKey?s:s.index(i.name),c=r(a),l=c?u.count(c):u.count();l.onsuccess=ze((function(t){return e(t.target.result)})),l.onerror=Yt(n)}))}}}(e)})),c={};return u.forEach((function(e){return c[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!c[e])throw new Error("Table '".concat(e,"' not found"));return c[e]},MIN_KEY:-1/0,MAX_KEY:rn(t),schema:i}}function ln(e,n){return n.reduce((function(e,n){var r=n.create;return t(t({},e),r(e))}),e)}function fn(e,t){var n=t.db,r=function(e,t,n,r){var o=n.IDBKeyRange;return n.indexedDB,{dbcore:ln(cn(t,o,r),e.dbcore)}}(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach((function(t){var n=t.name;e.core.schema.tables.some((function(e){return e.name===n}))&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))}))}function hn(e,t,n,r){n.forEach((function(n){var o=r[n];t.forEach((function(t){var r=v(t,n);(!r||"value"in r&&void 0===r.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?d(t,n,{get:function(){return this.table(n)},set:function(e){h(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,o))}))}))}function dn(e,t){t.forEach((function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]}))}function pn(e,t){return e._cfg.version-t._cfg.version}function yn(e,t,n,r){var o=e._dbSchema;n.objectStoreNames.contains("$meta")&&!o.$meta&&(o.$meta=nn("$meta",xn("")[0],[]),e._storeNames.push("$meta"));var a=e._createTransaction("readwrite",e._storeNames,o);a.create(n),a._completion.catch(r);var s=a._reject.bind(a),u=Ce.transless||Ce;Ge((function(){if(Ce.trans=a,Ce.transless=u,0!==t)return fn(e,n),function(e,t,n){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then((function(e){return null!=e?e:n})):Se.resolve(n)}(0,a,t).then((function(t){return function(e,t,n,r){var o=[],a=e._versions,s=e._dbSchema=wn(0,e.idbdb,r),u=a.filter((function(e){return e._cfg.version>=t}));if(0===u.length)return Se.resolve();function c(){return o.length?Se.resolve(o.shift()(n.idbtrans)).then(c):Se.resolve()}return u.forEach((function(a){o.push((function(){var o=s,u=a._cfg.dbschema;_n(e,o,r),_n(e,u,r),s=e._dbSchema=u;var c=vn(o,u);c.add.forEach((function(e){mn(r,e[0],e[1].primKey,e[1].indexes)})),c.change.forEach((function(e){if(e.recreate)throw new G.Upgrade("Not yet support for changing primary key");var t=r.objectStore(e.name);e.add.forEach((function(e){return bn(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),bn(t,e)})),e.del.forEach((function(e){return t.deleteIndex(e)}))}));var l=a._cfg.contentUpgrade;if(l&&a._cfg.version>t){fn(e,r),n._memoizedTables={};var f=$(u);c.del.forEach((function(e){f[e]=o[e]})),dn(e,[e.Transaction.prototype]),hn(e,[e.Transaction.prototype],i(f),f),n.schema=f;var h,d=N(l);d&&Xe();var p=Se.follow((function(){if((h=l(n))&&d){var e=Je.bind(null,null);h.then(e,e)}}));return h&&"function"==typeof h.then?Se.resolve(h):p.then((function(){return h}))}})),o.push((function(t){(function(e,t){[].slice.call(t.db.objectStoreNames).forEach((function(n){return null==e[n]&&t.db.deleteObjectStore(n)}))})(a._cfg.dbschema,t),dn(e,[e.Transaction.prototype]),hn(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema})),o.push((function(t){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===a._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter((function(e){return"$meta"!==e}))):t.objectStore("$meta").put(a._cfg.version,"version"))}))})),c().then((function(){gn(s,r)}))}(e,t,a,n)})).catch(s);i(o).forEach((function(e){mn(n,e,o[e].primKey,o[e].indexes)})),fn(e,n),Se.follow((function(){return e.on.populate.fire(a)})).catch(s)}))}function vn(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var o=e[n],i=t[n];if(o){var a={name:n,def:i,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(i.primKey.keyPath||"")||o.primKey.auto!==i.primKey.auto)a.recreate=!0,r.change.push(a);else{var s=o.idxByName,u=i.idxByName,c=void 0;for(c in s)u[c]||a.del.push(c);for(c in u){var l=s[c],f=u[c];l?l.src!==f.src&&a.change.push(f):a.add.push(f)}(a.del.length>0||a.add.length>0||a.change.length>0)&&r.change.push(a)}}else r.add.push([n,i])}return r}function mn(e,t,n,r){var o=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((function(e){return bn(o,e)})),o}function gn(e,t){i(e).forEach((function(n){t.db.objectStoreNames.contains(n)||(ue&&console.debug("Dexie: Creating missing table",n),mn(t,n,e[n].primKey,e[n].indexes))}))}function bn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function wn(e,t,n){var r={};return g(t.objectStoreNames,0).forEach((function(e){for(var t=n.objectStore(e),o=t.keyPath,i=en(tn(o),o||"",!0,!1,!!t.autoIncrement,o&&"string"!=typeof o,!0),a=[],s=0;s<t.indexNames.length;++s){var u=t.index(t.indexNames[s]);o=u.keyPath;var c=en(u.name,o,!!u.unique,!!u.multiEntry,!1,o&&"string"!=typeof o,!1);a.push(c)}r[e]=nn(e,i,a)})),r}function _n(e,t,n){for(var r=n.db.objectStoreNames,i=0;i<r.length;++i){var a=r[i],s=n.objectStore(a);e._hasGetAll="getAll"in s;for(var u=0;u<s.indexNames.length;++u){var c=s.indexNames[u],l=s.index(c).keyPath,f="string"==typeof l?l:"["+g(l).join("+")+"]";if(t[a]){var h=t[a].idxByName[f];h&&(h.name=c,delete t[a].idxByName[f],t[a].idxByName[c]=h)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function xn(e){return e.split(",").map((function(e,t){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return en(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),a(r),0===t)}))}var kn,$n=function(){function e(){}return e.prototype._parseStoresSpec=function(e,t){i(e).forEach((function(n){if(null!==e[n]){var r=xn(e[n]),o=r.shift();if(o.unique=!0,o.multi)throw new G.Schema("Primary key cannot be multi-valued");r.forEach((function(e){if(e.auto)throw new G.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new G.Schema("Index must have a name and cannot be an empty string")})),t[n]=nn(n,o,r)}}))},e.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?s(this._cfg.storesSource,e):e;var n=t._versions,r={},o={};return n.forEach((function(e){s(r,e._cfg.storesSource),o=e._cfg.dbschema={},e._parseStoresSpec(r,o)})),t._dbSchema=o,dn(t,[t._allTables,t,t.Transaction.prototype]),hn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],i(o),o),t._storeNames=i(o),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=se(this._cfg.contentUpgrade||Z,e),this},e}();function On(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new pr(yt,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function Cn(e){return e&&"function"==typeof e.databases}function En(e){return Ge((function(){return Ce.letThrough=!0,e()}))}function Pn(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()})).finally((function(){return clearInterval(e)})):Promise.resolve()}function jn(e){return!("from"in e)}var Sn=function(e,t){if(!this){var n=new Sn;return e&&"d"in e&&s(n,e),n}s(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function An(e,t,n){var r=xt(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(jn(e))return s(e,{from:t,to:n,d:1});var o=e.l,i=e.r;if(xt(n,e.from)<0)return o?An(o,t,n):e.l={from:t,to:n,d:1,l:null,r:null},In(e);if(xt(t,e.to)>0)return i?An(i,t,n):e.r={from:t,to:n,d:1,l:null,r:null},In(e);xt(t,e.from)<0&&(e.from=t,e.l=null,e.d=i?i.d+1:1),xt(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var a=!e.r;o&&!e.l&&Kn(e,o),i&&a&&Kn(e,i)}}function Kn(e,t){jn(t)||function e(t,n){var r=n.from,o=n.to,i=n.l,a=n.r;An(t,r,o),i&&e(t,i),a&&e(t,a)}(e,t)}function Tn(e,t){var n=Dn(t),r=n.next();if(r.done)return!1;for(var o=r.value,i=Dn(e),a=i.next(o.from),s=a.value;!r.done&&!a.done;){if(xt(s.from,o.to)<=0&&xt(s.to,o.from)>=0)return!0;xt(o.from,s.from)<0?o=(r=n.next(s.from)).value:s=(a=i.next(o.from)).value}return!1}function Dn(e){var t=jn(e)?null:{s:0,n:e};return{next:function(e){for(var n=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&xt(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||xt(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function In(e){var n,r,o=((null===(n=e.r)||void 0===n?void 0:n.d)||0)-((null===(r=e.l)||void 0===r?void 0:r.d)||0),i=o>1?"r":o<-1?"l":"";if(i){var a="r"===i?"l":"r",s=t({},e),u=e[i];e.from=u.from,e.to=u.to,e[i]=u[i],s[i]=u[a],e[a]=s,s.d=Bn(s)}e.d=Bn(e)}function Bn(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function qn(e,t){return i(t).forEach((function(n){e[n]?Kn(e[n],t[n]):e[n]=j(t[n])})),e}function Rn(e,t){return e.all||t.all||Object.keys(e).some((function(n){return t[n]&&Tn(t[n],e[n])}))}f(Sn.prototype,((kn={add:function(e){return Kn(this,e),this},addKey:function(e){return An(this,e,e),this},addKeys:function(e){var t=this;return e.forEach((function(e){return An(t,e,e)})),this}})[I]=function(){return Dn(this)},kn));var Mn={},Nn={},Fn=!1;function Ln(e,t){qn(Nn,e),Fn||(Fn=!0,setTimeout((function(){Fn=!1;var e=Nn;Nn={},zn(e,!1)}),0))}function zn(e,t){void 0===t&&(t=!1);var n=new Set;if(e.all)for(var r=0,o=Object.values(Mn);r<o.length;r++)Un(s=o[r],e,n,t);else for(var i in e){var a=/^idb\:\/\/(.*)\/(.*)\//.exec(i);if(a){var s,u=a[1],c=a[2];(s=Mn["idb://".concat(u,"/").concat(c)])&&Un(s,e,n,t)}}n.forEach((function(e){return e()}))}function Un(e,t,n,r){for(var o=[],i=0,a=Object.entries(e.queries.query);i<a.length;i++){for(var s=a[i],u=s[0],c=[],l=0,f=s[1];l<f.length;l++){var h=f[l];Rn(t,h.obsSet)?h.subscribers.forEach((function(e){return n.add(e)})):r&&c.push(h)}r&&o.push([u,c])}if(r)for(var d=0,p=o;d<p.length;d++){var y=p[d];u=y[0],c=y[1],e.queries.query[u]=c}}function Hn(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?st(t.dbOpenError):e}));t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,o=Math.round(10*e.verno),a=!1;function s(){if(t.openCanceller!==r)throw new G.DatabaseClosed("db.open() was cancelled")}var u=t.dbReadyResolve,c=null,l=!1,f=function(){return new Se((function(r,u){if(s(),!n)throw new G.MissingAPI;var h=e.name,d=t.autoSchema||!o?n.open(h):n.open(h,o);if(!d)throw new G.MissingAPI;d.onerror=Yt(u),d.onblocked=ze(e._fireOnBlocked),d.onupgradeneeded=ze((function(r){if(c=d.transaction,t.autoSchema&&!e._options.allowEmptyDB){d.onerror=Qt,c.abort(),d.result.close();var o=n.deleteDatabase(h);o.onsuccess=o.onerror=ze((function(){u(new G.NoSuchDatabase("Database ".concat(h," doesnt exist")))}))}else{c.onerror=Yt(u);var i=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;l=i<1,e.idbdb=d.result,a&&function(e,t){gn(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=wn(0,e.idbdb,t);_n(e,e._dbSchema,t);for(var r=function(e){if(e.change.length||e.recreate)return console.warn("Unable to patch indexes of table ".concat(e.name," because it has changes on the type of index or primary key.")),{value:void 0};var n=t.objectStore(e.name);e.add.forEach((function(t){ue&&console.debug("Dexie upgrade patch: Creating missing index ".concat(e.name,".").concat(t.src)),bn(n,t)}))},o=0,i=vn(n,e._dbSchema).change;o<i.length;o++){var a=r(i[o]);if("object"==typeof a)return a.value}}(e,c),yn(e,i/10,c,u)}}),u),d.onsuccess=ze((function(){c=null;var n,s=e.idbdb=d.result,u=g(s.objectStoreNames);if(u.length>0)try{var p=s.transaction(1===(n=u).length?n[0]:n,"readonly");if(t.autoSchema)!function(e,t,n){e.verno=t.version/10;var r=e._dbSchema=wn(0,t,n);e._storeNames=g(t.objectStoreNames,0),hn(e,[e._allTables],i(r),r)}(e,s,p);else if(_n(e,e._dbSchema,p),!function(e,t){var n=vn(wn(0,e.idbdb,t),e._dbSchema);return!(n.add.length||n.change.some((function(e){return e.add.length||e.change.length})))}(e,p)&&!a)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),s.close(),o=s.version+1,a=!0,r(f());fn(e,p)}catch(e){}pt.push(e),s.onversionchange=ze((function(n){t.vcFired=!0,e.on("versionchange").fire(n)})),s.onclose=ze((function(t){e.on("close").fire(t)})),l&&function(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!Cn(n)&&t!==yt&&On(n,r).put({name:t}).catch(Z)}(e._deps,h),r()}),u)})).catch((function(e){switch(null==e?void 0:e.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),f();break;case"VersionError":if(o>0)return o=0,f()}return Se.reject(e)}))};return Se.race([r,("undefined"==typeof navigator?Se.resolve():Pn()).then(f)]).then((function(){return s(),t.onReadyBeingFired=[],Se.resolve(En((function(){return e.on.ready.fire(e.vip)}))).then((function n(){if(t.onReadyBeingFired.length>0){var r=t.onReadyBeingFired.reduce(se,Z);return t.onReadyBeingFired=[],Se.resolve(En((function(){return r(e.vip)}))).then(n)}}))})).finally((function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)})).catch((function(n){t.dbOpenError=n;try{c&&c.abort()}catch(e){}return r===t.openCanceller&&e._close(),st(n)})).finally((function(){t.openComplete=!0,u()})).then((function(){if(l){var t={};e.tables.forEach((function(n){n.schema.indexes.forEach((function(r){r.name&&(t["idb://".concat(e.name,"/").concat(n.name,"/").concat(r.name)]=new Sn(-1/0,[[[]]]))})),t["idb://".concat(e.name,"/").concat(n.name,"/")]=t["idb://".concat(e.name,"/").concat(n.name,"/:dels")]=new Sn(-1/0,[[[]]])})),Jt(Gt).fire(t),zn(t,!0)}return e}))}function Vn(e){var t=function(t){return e.next(t)},n=o(t),r=o((function(t){return e.throw(t)}));function o(e){return function(t){var o=e(t),i=o.value;return o.done?i:i&&"function"==typeof i.then?i.then(n,r):a(i)?Promise.all(i).then(n,r):n(i)}}return o(t)()}function Wn(e,t,n){var r=arguments.length;if(r<2)throw new G.InvalidArgument("Too few arguments");for(var o=new Array(r-1);--r;)o[r-1]=arguments[r];return n=o.pop(),[e,C(o),n]}function Yn(e,t,n,r,o){return Se.resolve().then((function(){var i=Ce.transless||Ce,a=e._createTransaction(t,n,e._dbSchema,r);a.explicit=!0;var s={trans:a,transless:i};if(r)a.idbtrans=r.idbtrans;else try{a.create(),a.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(r){return r.name===Y.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then((function(){return Yn(e,t,n,null,o)}))):st(r)}var u,c=N(o);c&&Xe();var l=Se.follow((function(){if(u=o.call(a,a))if(c){var e=Je.bind(null,null);u.then(e,e)}else"function"==typeof u.next&&"function"==typeof u.throw&&(u=Vn(u))}),s);return(u&&"function"==typeof u.then?Se.resolve(u).then((function(e){return a.active?e:st(new G.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):l.then((function(){return u}))).then((function(e){return r&&a._resolve(),a._completion.then((function(){return e}))})).catch((function(e){return a._reject(e),st(e)}))}))}function Qn(e,t,n){for(var r=a(e)?e.slice():[e],o=0;o<n;++o)r.push(t);return r}var Gn={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return t(t({},e),{table:function(n){var r=e.table(n),o=r.schema,i={},a=[];function s(e,n,r){var o=un(e),u=i[o]=i[o]||[],c=null==e?0:"string"==typeof e?1:e.length,l=n>0,f=t(t({},r),{name:l?"".concat(o,"(virtual-from:").concat(r.name,")"):r.name,lowLevelIndex:r,isVirtual:l,keyTail:n,keyLength:c,extractKey:on(e),unique:!l&&r.unique});return u.push(f),f.isPrimaryKey||a.push(f),c>1&&s(2===c?e[0]:e.slice(0,c-1),n+1,r),u.sort((function(e,t){return e.keyTail-t.keyTail})),f}var u=s(o.primaryKey.keyPath,0,o.primaryKey);i[":id"]=[u];for(var c=0,l=o.indexes;c<l.length;c++){var f=l[c];s(f.keyPath,0,f)}function h(n){var r,o,i=n.query.index;return i.isVirtual?t(t({},n),{query:{index:i.lowLevelIndex,range:(r=n.query.range,o=i.keyTail,{type:1===r.type?2:r.type,lower:Qn(r.lower,r.lowerOpen?e.MAX_KEY:e.MIN_KEY,o),lowerOpen:!0,upper:Qn(r.upper,r.upperOpen?e.MIN_KEY:e.MAX_KEY,o),upperOpen:!0})}}):n}var d=t(t({},r),{schema:t(t({},o),{primaryKey:u,indexes:a,getIndexByKeyPath:function(e){var t=i[un(e)];return t&&t[0]}}),count:function(e){return r.count(h(e))},query:function(e){return r.query(h(e))},openCursor:function(t){var n=t.query.index,o=n.keyTail,i=n.isVirtual,a=n.keyLength;if(!i)return r.openCursor(t);return r.openCursor(h(t)).then((function(n){return n&&function(n){var r=Object.create(n,{continue:{value:function(r){null!=r?n.continue(Qn(r,t.reverse?e.MAX_KEY:e.MIN_KEY,o)):t.unique?n.continue(n.key.slice(0,a).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,o)):n.continue()}},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(Qn(t,e.MAX_KEY,o),r)}},primaryKey:{get:function(){return n.primaryKey}},key:{get:function(){var e=n.key;return 1===a?e[0]:e.slice(0,a)}},value:{get:function(){return n.value}}});return r}(n)}))}});return d}})}};function Xn(e,t,n,r){return n=n||{},r=r||"",i(e).forEach((function(o){if(l(t,o)){var i=e[o],a=t[o];if("object"==typeof i&&"object"==typeof a&&i&&a){var s=D(i);s!==D(a)?n[r+o]=t[o]:"Object"===s?Xn(i,a,n,r+o+"."):i!==a&&(n[r+o]=t[o])}else i!==a&&(n[r+o]=t[o])}else n[r+o]=void 0})),i(t).forEach((function(o){l(e,o)||(n[r+o]=t[o])})),n}function Jn(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}var Zn={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return t(t({},e),{table:function(n){var o=e.table(n),i=o.schema.primaryKey,a=t(t({},o),{mutate:function(e){var a=Ce.trans,s=a.table(n).hook,u=s.deleting,c=s.creating,f=s.updating;switch(e.type){case"add":if(c.fire===Z)break;return a._promise("readwrite",(function(){return h(e)}),!0);case"put":if(c.fire===Z&&f.fire===Z)break;return a._promise("readwrite",(function(){return h(e)}),!0);case"delete":if(u.fire===Z)break;return a._promise("readwrite",(function(){return h(e)}),!0);case"deleteRange":if(u.fire===Z)break;return a._promise("readwrite",(function(){return function(e){return d(e.trans,e.range,1e4)}(e)}),!0)}return o.mutate(e);function h(e){var n=Ce.trans,a=e.keys||Jn(i,e);if(!a)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?t(t({},e),{keys:a}):t({},e)).type&&(e.values=r([],e.values,!0)),e.keys&&(e.keys=r([],e.keys,!0)),function(e,t,n){return"add"===t.type?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}(o,e,a).then((function(t){var r=a.map((function(r,o){var a=t[o],s={onerror:null,onsuccess:null};if("delete"===e.type)u.fire.call(s,r,a,n);else if("add"===e.type||void 0===a){var h=c.fire.call(s,r,e.values[o],n);null==r&&null!=h&&(r=h,e.keys[o]=r,i.outbound||k(e.values[o],i.keyPath,r))}else{var d=Xn(a,e.values[o]),p=f.fire.call(s,d,r,a,n);if(p){var y=e.values[o];Object.keys(p).forEach((function(e){l(y,e)?y[e]=p[e]:k(y,e,p[e])}))}}return s}));return o.mutate(e).then((function(n){for(var o=n.failures,i=n.results,s=n.numFailures,u=n.lastResult,c=0;c<a.length;++c){var l=i?i[c]:a[c],f=r[c];null==l?f.onerror&&f.onerror(o[c]):f.onsuccess&&f.onsuccess("put"===e.type&&t[c]?e.values[c]:l)}return{failures:o,results:i,numFailures:s,lastResult:u}})).catch((function(e){return r.forEach((function(t){return t.onerror&&t.onerror(e)})),Promise.reject(e)}))}))}function d(e,n,r){return o.query({trans:e,values:!1,query:{index:i,range:n},limit:r}).then((function(o){var i=o.result;return h({type:"delete",keys:i,trans:e}).then((function(o){return o.numFailures>0?Promise.reject(o.failures[0]):i.length<r?{failures:[],numFailures:0,lastResult:void 0}:d(e,t(t({},n),{lower:i[i.length-1],lowerOpen:!0}),r)}))}))}}});return a}})}};function er(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;for(var r=[],o=0,i=0;o<t.keys.length&&i<e.length;++o)0===xt(t.keys[o],e[i])&&(r.push(n?A(t.values[o]):t.values[o]),++i);return r.length===e.length?r:null}catch(e){return null}}var tr={stack:"dbcore",level:-1,create:function(e){return{table:function(n){var r=e.table(n);return t(t({},r),{getMany:function(e){if(!e.cache)return r.getMany(e);var t=er(e.keys,e.trans._cache,"clone"===e.cache);return t?Se.resolve(t):r.getMany(e).then((function(t){return e.trans._cache={keys:e.keys,values:"clone"===e.cache?A(t):t},t}))},mutate:function(e){return"add"!==e.type&&(e.trans._cache=null),r.mutate(e)}})}}}};function nr(e,t){return"readonly"===e.trans.mode&&!!e.subscr&&!e.trans.explicit&&"disabled"!==e.trans.db._options.cache&&!t.schema.primaryKey.outbound}function rr(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var or={stack:"dbcore",level:0,name:"Observability",create:function(e){var n=e.schema.name,r=new Sn(e.MIN_KEY,e.MAX_KEY);return t(t({},e),{transaction:function(t,n,r){if(Ce.subscr&&"readonly"!==n)throw new G.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ce.querier));return e.transaction(t,n,r)},table:function(o){var s=e.table(o),u=s.schema,c=u.primaryKey,l=u.indexes,f=c.extractKey,h=c.outbound,d=c.autoIncrement&&l.filter((function(e){return e.compound&&e.keyPath.includes(c.keyPath)})),p=t(t({},s),{mutate:function(e){var t=e.trans,i=e.mutatedParts||(e.mutatedParts={}),l=function(e){var t="idb://".concat(n,"/").concat(o,"/").concat(e);return i[t]||(i[t]=new Sn)},f=l(""),h=l(":dels"),p=e.type,y="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[Jn(c,e).filter((function(e){return e})),e.values]:[],v=y[0],m=y[1],g=e.trans._cache;if(a(v)){f.addKeys(v);var b="delete"===p||v.length===m.length?er(v,g):null;b||h.addKeys(v),(b||m)&&function(e,t,n,r){function o(t){var o=e(t.name||"");function i(e){return null!=e?t.extractKey(e):null}var s=function(e){return t.multiEntry&&a(e)?e.forEach((function(e){return o.addKey(e)})):o.addKey(e)};(n||r).forEach((function(e,t){var o=n&&i(n[t]),a=r&&i(r[t]);0!==xt(o,a)&&(null!=o&&s(o),null!=a&&s(a))}))}t.indexes.forEach(o)}(l,u,b,m)}else if(v){var w={from:v.lower,to:v.upper};h.add(w),f.add(w)}else f.add(r),h.add(r),u.indexes.forEach((function(e){return l(e.name).add(r)}));return s.mutate(e).then((function(n){return!v||"add"!==e.type&&"put"!==e.type||(f.addKeys(n.results),d&&d.forEach((function(t){var r=e.values.map((function(e){return t.extractKey(e)})),o=t.keyPath.findIndex((function(e){return e===c.keyPath}));n.results.forEach((function(e){return r[o]=e})),l(t.name).addKeys(r)}))),t.mutatedParts=qn(t.mutatedParts||{},i),n}))}}),y=function(t){var n,r,o=t.query,i=o.index,a=o.range;return[i,new Sn(null!==(n=a.lower)&&void 0!==n?n:e.MIN_KEY,null!==(r=a.upper)&&void 0!==r?r:e.MAX_KEY)]},v={get:function(e){return[c,new Sn(e.key)]},getMany:function(e){return[c,(new Sn).addKeys(e.keys)]},count:y,query:y,openCursor:y};return i(v).forEach((function(e){p[e]=function(i){var a=Ce.subscr,u=!!a,c=nr(Ce,s)&&rr(e,i)?i.obsSet={}:a;if(u){var l=function(e){var t="idb://".concat(n,"/").concat(o,"/").concat(e);return c[t]||(c[t]=new Sn)},d=l(""),p=l(":dels"),y=v[e](i),m=y[0],g=y[1];if("query"===e&&m.isPrimaryKey&&!i.values?p.add(g):l(m.name||"").add(g),!m.isPrimaryKey){if("count"!==e){var b="query"===e&&h&&i.values&&s.query(t(t({},i),{values:!1}));return s[e].apply(this,arguments).then((function(t){if("query"===e){if(h&&i.values)return b.then((function(e){var n=e.result;return d.addKeys(n),t}));var n=i.values?t.result.map(f):t.result;i.values?d.addKeys(n):p.addKeys(n)}else if("openCursor"===e){var r=t,o=i.values;return r&&Object.create(r,{key:{get:function(){return p.addKey(r.primaryKey),r.key}},primaryKey:{get:function(){var e=r.primaryKey;return p.addKey(e),e}},value:{get:function(){return o&&d.addKey(r.primaryKey),r.value}}})}return t}))}p.add(r)}}return s[e].apply(this,arguments)}})),p}})}};function ir(e,n,r){if(0===r.numFailures)return n;if("deleteRange"===n.type)return null;var o=n.keys?n.keys.length:"values"in n&&n.values?n.values.length:1;if(r.numFailures===o)return null;var i=t({},n);return a(i.keys)&&(i.keys=i.keys.filter((function(e,t){return!(t in r.failures)}))),"values"in i&&a(i.values)&&(i.values=i.values.filter((function(e,t){return!(t in r.failures)}))),i}function ar(e,t){return function(e,t){return void 0===t.lower||(t.lowerOpen?xt(e,t.lower)>0:xt(e,t.lower)>=0)}(e,t)&&function(e,t){return void 0===t.upper||(t.upperOpen?xt(e,t.upper)<0:xt(e,t.upper)<=0)}(e,t)}function sr(e,t,n,r,o,i){if(!n||0===n.length)return e;var s=t.query.index,u=s.multiEntry,c=t.query.range,l=r.schema.primaryKey.extractKey,f=s.extractKey,h=(s.lowLevelIndex||s).extractKey,d=n.reduce((function(e,n){var r=e,o="add"===n.type||"put"===n.type?n.values.filter((function(e){var t=f(e);return u&&a(t)?t.some((function(e){return ar(e,c)})):ar(t,c)})).map((function(e){return e=A(e),i&&Object.freeze(e),e})):[];switch(n.type){case"add":r=e.concat(t.values?o:o.map((function(e){return l(e)})));break;case"put":var s=(new Sn).addKeys(n.values.map((function(e){return l(e)})));r=e.filter((function(e){var n=t.values?l(e):e;return!Tn(new Sn(n),s)})).concat(t.values?o:o.map((function(e){return l(e)})));break;case"delete":var h=(new Sn).addKeys(n.keys);r=e.filter((function(e){var n=t.values?l(e):e;return!Tn(new Sn(n),h)}));break;case"deleteRange":var d=n.range;r=e.filter((function(e){return!ar(l(e),d)}))}return r}),e);return d===e?e:(d.sort((function(e,t){return xt(h(e),h(t))||xt(l(e),l(t))})),t.limit&&t.limit<1/0&&(d.length>t.limit?d.length=t.limit:e.length===t.limit&&d.length<t.limit&&(o.dirty=!0)),i?Object.freeze(d):d)}function ur(e,t){return 0===xt(e.lower,t.lower)&&0===xt(e.upper,t.upper)&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function cr(e,t){return function(e,t,n,r){if(void 0===e)return void 0!==t?-1:0;if(void 0===t)return 1;var o=xt(e,t);if(0===o){if(n&&r)return 0;if(n)return 1;if(r)return-1}return o}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&function(e,t,n,r){if(void 0===e)return void 0!==t?1:0;if(void 0===t)return-1;var o=xt(e,t);if(0===o){if(n&&r)return 0;if(n)return-1;if(r)return 1}return o}(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function lr(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",(function(){e.subscribers.delete(n),0===e.subscribers.size&&function(e,t){setTimeout((function(){0===e.subscribers.size&&q(t,e)}),3e3)}(e,t)}))}var fr={stack:"dbcore",level:0,name:"Cache",create:function(e){var n=e.schema.name,r=t(t({},e),{transaction:function(t,r,o){var i=e.transaction(t,r,o);if("readwrite"===r){var a=new AbortController,s=a.signal,u=function(o){return function(){if(a.abort(),"readwrite"===r){for(var s=new Set,u=0,c=t;u<c.length;u++){var l=c[u],f=Mn["idb://".concat(n,"/").concat(l)];if(f){var h=e.table(l),d=f.optimisticOps.filter((function(e){return e.trans===i}));if(i._explicit&&o&&i.mutatedParts)for(var p=0,y=Object.values(f.queries.query);p<y.length;p++)for(var v=0,m=(w=y[p]).slice();v<m.length;v++)Rn((k=m[v]).obsSet,i.mutatedParts)&&(q(w,k),k.subscribers.forEach((function(e){return s.add(e)})));else if(d.length>0){f.optimisticOps=f.optimisticOps.filter((function(e){return e.trans!==i}));for(var g=0,b=Object.values(f.queries.query);g<b.length;g++)for(var w,_=0,x=(w=b[g]).slice();_<x.length;_++){var k;if(null!=(k=x[_]).res&&i.mutatedParts)if(o&&!k.dirty){var $=Object.isFrozen(k.res),O=sr(k.res,k.req,d,h,k,$);k.dirty?(q(w,k),k.subscribers.forEach((function(e){return s.add(e)}))):O!==k.res&&(k.res=O,k.promise=Se.resolve({result:O}))}else k.dirty&&q(w,k),k.subscribers.forEach((function(e){return s.add(e)}))}}}}s.forEach((function(e){return e()}))}}};i.addEventListener("abort",u(!1),{signal:s}),i.addEventListener("error",u(!1),{signal:s}),i.addEventListener("complete",u(!0),{signal:s})}return i},table:function(r){var o=e.table(r),i=o.schema.primaryKey,a=t(t({},o),{mutate:function(e){var a=Ce.trans;if(i.outbound||"disabled"===a.db._options.cache||a.explicit)return o.mutate(e);var s=Mn["idb://".concat(n,"/").concat(r)];if(!s)return o.mutate(e);var u=o.mutate(e);return"add"!==e.type&&"put"!==e.type||!(e.values.length>=50||Jn(i,e).some((function(e){return null==e})))?(s.optimisticOps.push(e),e.mutatedParts&&Ln(e.mutatedParts),u.then((function(t){if(t.numFailures>0){q(s.optimisticOps,e);var n=ir(0,e,t);n&&s.optimisticOps.push(n),e.mutatedParts&&Ln(e.mutatedParts)}})),u.catch((function(){q(s.optimisticOps,e),e.mutatedParts&&Ln(e.mutatedParts)}))):u.then((function(n){var r=t(t({},e),{values:e.values.map((function(e,r){var o,a=(null===(o=i.keyPath)||void 0===o?void 0:o.includes("."))?A(e):t({},e);return k(a,i.keyPath,n.results[r]),a}))}),o=ir(0,r,n);s.optimisticOps.push(o),queueMicrotask((function(){return e.mutatedParts&&Ln(e.mutatedParts)}))})),u},query:function(e){var t;if(!nr(Ce,o)||!rr("query",e))return o.query(e);var i="immutable"===(null===(t=Ce.trans)||void 0===t?void 0:t.db._options.cache),a=Ce,s=a.requery,u=a.signal,c=function(e,t,n,r){var o=Mn["idb://".concat(e,"/").concat(t)];if(!o)return[];var i=o.queries[n];if(!i)return[null,!1,o,null];var a=i[(r.query?r.query.index.name:null)||""];if(!a)return[null,!1,o,null];switch(n){case"query":var s=a.find((function(e){return e.req.limit===r.limit&&e.req.values===r.values&&ur(e.req.query.range,r.query.range)}));return s?[s,!0,o,a]:[a.find((function(e){return("limit"in e.req?e.req.limit:1/0)>=r.limit&&(!r.values||e.req.values)&&cr(e.req.query.range,r.query.range)})),!1,o,a];case"count":var u=a.find((function(e){return ur(e.req.query.range,r.query.range)}));return[u,!!u,o,a]}}(n,r,"query",e),l=c[0],f=c[1],h=c[2],d=c[3];if(l&&f)l.obsSet=e.obsSet;else{var p=o.query(e).then((function(e){var t=e.result;if(l&&(l.res=t),i){for(var n=0,r=t.length;n<r;++n)Object.freeze(t[n]);Object.freeze(t)}else e.result=A(t);return e})).catch((function(e){return d&&l&&q(d,l),Promise.reject(e)}));l={obsSet:e.obsSet,promise:p,subscribers:new Set,type:"query",req:e,dirty:!1},d?d.push(l):(d=[l],h||(h=Mn["idb://".concat(n,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),h.queries.query[e.query.index.name||""]=d)}return lr(l,d,s,u),l.promise.then((function(t){return{result:sr(t.result,e,null==h?void 0:h.optimisticOps,o,l,i)}}))}});return a}});return r}};function hr(e,t){return new Proxy(e,{get:function(e,n,r){return"db"===n?t:Reflect.get(e,n,r)}})}var dr,pr=function(){function e(n,r){var o=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=r=t({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};var a=r.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var s,u={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Z,dbReadyPromise:null,cancelOpen:Z,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:r.autoOpen};u.dbReadyPromise=new Se((function(e){u.dbReadyResolve=e})),u.openCanceller=new Se((function(e,t){u.cancelOpen=t})),this._state=u,this.name=n,this.on=Ct(this,"populate","blocked","versionchange","close",{ready:[se,Z]}),this.on.ready.subscribe=b(this.on.ready.subscribe,(function(t){return function(n,r){e.vip((function(){var e=o._state;if(e.openComplete)e.dbOpenError||Se.resolve().then(n),r&&t(n);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(n),r&&t(n);else{t(n);var i=o;r||t((function e(){i.on.ready.unsubscribe(n),i.on.ready.unsubscribe(e)}))}}))}})),this.Collection=(s=this,Et(qt.prototype,(function(e,t){this.db=s;var n=bt,r=null;if(t)try{n=t()}catch(e){r=e}var o=e._ctx,i=o.table,a=i.hook.reading.fire;this._ctx={table:i,index:o.index,isPrimKey:!o.index||i.schema.primKey.keyPath&&o.index===i.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:o.or,valueMapper:a!==ee?a:null}}))),this.Table=function(e){return Et(Ot.prototype,(function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:Ct(null,{creating:[re,Z],reading:[te,ee],updating:[ie,Z],deleting:[oe,Z]})}))}(this),this.Transaction=function(e){return Et(Zt.prototype,(function(t,n,r,o,i){var a=this;this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.chromeTransactionDurability=o,this.idbtrans=null,this.on=Ct(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Se((function(e,t){a._resolve=e,a._reject=t})),this._completion.then((function(){a.active=!1,a.on.complete.fire()}),(function(e){var t=a.active;return a.active=!1,a.on.error.fire(e),a.parent?a.parent._reject(e):t&&a.idbtrans&&a.idbtrans.abort(),st(e)}))}))}(this),this.Version=function(e){return Et($n.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return Et(Wt.prototype,(function(t,n,r){if(this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r},this._cmp=this._ascending=xt,this._descending=function(e,t){return xt(t,e)},this._max=function(e,t){return xt(e,t)>0?e:t},this._min=function(e,t){return xt(e,t)<0?e:t},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new G.MissingAPI}))}(this),this.on("versionchange",(function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(o.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(o.name,"'. Closing db now to resume the delete request.")),o.close({disableAutoOpen:!1})})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('".concat(o.name,"') was blocked")):console.warn("Upgrade '".concat(o.name,"' blocked by other connection holding version ").concat(e.oldVersion/10))})),this._maxKey=rn(r.IDBKeyRange),this._createTransaction=function(e,t,n,r){return new o.Transaction(e,t,n,o._options.chromeTransactionDurability,r)},this._fireOnBlocked=function(e){o.on("blocked").fire(e),pt.filter((function(e){return e.name===o.name&&e!==o&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))},this.use(tr),this.use(fr),this.use(or),this.use(Gn),this.use(Zn);var c=new Proxy(this,{get:function(e,t,n){if("_vip"===t)return!0;if("table"===t)return function(e){return hr(o.table(e),c)};var r=Reflect.get(e,t,n);return r instanceof Ot?hr(r,c):"tables"===t?r.map((function(e){return hr(e,c)})):"_createTransaction"===t?function(){return hr(r.apply(this,arguments),c)}:r}});this.vip=c,a.forEach((function(e){return e(o)}))}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new G.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new G.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter((function(t){return t._cfg.version===e}))[0];return n||(n=new this.Version(e),t.push(n),t.sort(pn),n.stores({}),this._state.autoSchema=!1,n)},e.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||Ce.letThrough||this._vip)?e():new Se((function(e,n){if(t._state.openComplete)return n(new G.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void n(new G.DatabaseClosed);t.open().catch(Z)}t._state.dbReadyPromise.then(e,n)})).then(e)},e.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,o=e.name;o&&this.unuse({stack:t,name:o});var i=this._middlewares[t]||(this._middlewares[t]=[]);return i.push({stack:t,create:n,level:null==r?10:r,name:o}),i.sort((function(e,t){return e.level-t.level})),this},e.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(e){return r?e.create!==r:!!n&&e.name!==n}))),this},e.prototype.open=function(){var e=this;return ot(Oe,(function(){return Hn(e)}))},e.prototype._close=function(){var e=this._state,t=pt.indexOf(this);if(t>=0&&pt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(e){}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new Se((function(t){e.dbReadyResolve=t})),e.openCanceller=new Se((function(t,n){e.cancelOpen=n})))},e.prototype.close=function(e){var t=(void 0===e?{disableAutoOpen:!0}:e).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new G.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new G.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},e.prototype.delete=function(e){var t=this;void 0===e&&(e={disableAutoOpen:!0});var n=arguments.length>0&&"object"!=typeof arguments[0],r=this._state;return new Se((function(o,i){var a=function(){t.close(e);var n=t._deps.indexedDB.deleteDatabase(t.name);n.onsuccess=ze((function(){(function(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!Cn(n)&&t!==yt&&On(n,r).delete(t).catch(Z)})(t._deps,t.name),o()})),n.onerror=Yt(i),n.onblocked=t._fireOnBlocked};if(n)throw new G.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(a):a()}))},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return null!==this.idbdb},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},e.prototype.hasFailed=function(){return null!==this._state.dbOpenError},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var e=this;return i(this._allTables).map((function(t){return e._allTables[t]}))},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var e=Wn.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,t,n){var r=this,o=Ce.trans;o&&o.db===this&&-1===e.indexOf("!")||(o=null);var i,a,s=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(a=t.map((function(e){var t=e instanceof r.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||e===vt)i=vt;else{if("rw"!=e&&e!=mt)throw new G.InvalidArgument("Invalid transaction mode: "+e);i=mt}if(o){if(o.mode===vt&&i===mt){if(!s)throw new G.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&a.forEach((function(e){if(o&&-1===o.storeNames.indexOf(e)){if(!s)throw new G.SubTransaction("Table "+e+" not included in parent transaction.");o=null}})),s&&o&&!o.active&&(o=null)}}catch(e){return o?o._promise(null,(function(t,n){n(e)})):st(e)}var u=Yn.bind(null,this,i,a,o,n);return o?o._promise(i,u,"lock"):Ce.trans?ot(Ce.transless,(function(){return r._whenReady(u)})):this._whenReady(u)},e.prototype.table=function(e){if(!l(this._allTables,e))throw new G.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},e}(),yr="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable",vr=function(){function e(e){this._subscribe=e}return e.prototype.subscribe=function(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})},e.prototype[yr]=function(){return this},e}();try{dr={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch(e){dr={indexedDB:null,IDBKeyRange:null}}function mr(e){var t,n=!1,r=new vr((function(r){var o=N(e);var i,a=!1,s={},u={},c={get closed(){return a},unsubscribe:function(){a||(a=!0,i&&i.abort(),f&&Jt.storagemutated.unsubscribe(d))}};r.start&&r.start(c);var f=!1,h=function(){return at(p)};var d=function(e){qn(s,e),Rn(u,s)&&h()},p=function(){if(!a&&dr.indexedDB){s={};var c={};i&&i.abort(),i=new AbortController;var p={subscr:c,signal:i.signal,requery:h,querier:e,trans:null},y=function(t){var n=Me();try{o&&Xe();var r=Ge(e,t);return o&&(r=r.finally(Je)),r}finally{n&&Ne()}}(p);Promise.resolve(y).then((function(e){n=!0,t=e,a||p.signal.aborted||(s={},function(e){for(var t in e)if(l(e,t))return!1;return!0}(u=c)||f||(Jt(Gt,d),f=!0),at((function(){return!a&&r.next&&r.next(e)})))}),(function(e){n=!1,["DatabaseClosedError","AbortError"].includes(null==e?void 0:e.name)||a||at((function(){a||r.error&&r.error(e)}))}))}};return setTimeout(h,0),c}));return r.hasValue=function(){return n},r.getValue=function(){return t},r}var gr=pr;function br(e){var t=_r;try{_r=!0,Jt.storagemutated.fire(e),zn(e,!0)}finally{_r=t}}f(gr,t(t({},J),{delete:function(e){return new gr(e,{addons:[]}).delete()},exists:function(e){return new gr(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){try{return function(e){var t=e.indexedDB,n=e.IDBKeyRange;return Cn(t)?Promise.resolve(t.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return e!==yt}))})):On(t,n).toCollection().primaryKeys()}(gr.dependencies).then(e)}catch(e){return st(new G.MissingAPI)}},defineClass:function(){return function(e){s(this,e)}},ignoreTransaction:function(e){return Ce.trans?ot(Ce.transless,e):e()},vip:En,async:function(e){return function(){try{var t=Vn(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Se.resolve(t)}catch(e){return st(e)}}},spawn:function(e,t,n){try{var r=Vn(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Se.resolve(r)}catch(e){return st(e)}},currentTransaction:{get:function(){return Ce.trans||null}},waitFor:function(e,t){var n=Se.resolve("function"==typeof e?gr.ignoreTransaction(e):e).timeout(t||6e4);return Ce.trans?Ce.trans.waitFor(n):n},Promise:Se,debug:{get:function(){return ue},set:function(e){ce(e)}},derive:p,extend:s,props:f,override:b,Events:Ct,on:Jt,liveQuery:mr,extendObservabilitySet:qn,getByKeyPath:x,setByKeyPath:k,delByKeyPath:function(e,t){"string"==typeof t?k(e,t,void 0):"length"in t&&[].map.call(t,(function(t){k(e,t,void 0)}))},shallowClone:$,deepClone:A,getObjectDiff:Xn,cmp:xt,asap:_,minKey:ft,addons:[],connections:pt,errnames:Y,dependencies:dr,cache:Mn,semVer:ct,version:ct.split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,n){return e+t/Math.pow(10,2*n)}))})),gr.maxKey=rn(gr.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(Jt(Gt,(function(e){var t;_r||(t=new CustomEvent(Xt,{detail:e}),_r=!0,dispatchEvent(t),_r=!1)})),addEventListener(Xt,(function(e){var t=e.detail;_r||br(t)})));var wr,_r=!1,xr=function(){};return"undefined"!=typeof BroadcastChannel&&((xr=function(){(wr=new BroadcastChannel(Xt)).onmessage=function(e){return e.data&&br(e.data)}})(),"function"==typeof wr.unref&&wr.unref(),Jt(Gt,(function(e){_r||wr.postMessage(e)}))),"undefined"!=typeof addEventListener&&(addEventListener("pagehide",(function(e){if(!pr.disableBfCache&&e.persisted){ue&&console.debug("Dexie: handling persisted pagehide"),null==wr||wr.close();for(var t=0,n=pt;t<n.length;t++)n[t].close({disableAutoOpen:!1})}})),addEventListener("pageshow",(function(e){!pr.disableBfCache&&e.persisted&&(ue&&console.debug("Dexie: handling persisted pageshow"),xr(),br({all:new Sn(-1/0,[[]])}))}))),Se.rejectionMapper=function(e,t){if(!e||e instanceof U||e instanceof TypeError||e instanceof SyntaxError||!e.name||!X[e.name])return e;var n=new X[e.name](t||e.message,e);return"stack"in e&&d(n,"stack",{get:function(){return this.inner.stack}}),n},ce(ue),t(pr,Object.freeze({__proto__:null,Dexie:pr,liveQuery:mr,Entity:_t,cmp:xt,PropModSymbol:It,PropModification:Bt,replacePrefix:function(e,t){return new Bt({replacePrefix:[e,t]})},default:pr,RangeSet:Sn,mergeRanges:Kn,rangesOverlap:Tn}),{default:pr}),pr}()}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{"use strict";function e(){}const t=e=>e;function r(e){return e()}function o(){return Object.create(null)}function i(e){e.forEach(r)}function a(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function u(t,...n){if(null==t){for(const e of n)e(void 0);return e}const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function c(e){let t;return u(e,(e=>t=e))(),t}function l(e,t,n){e.$$.on_destroy.push(u(t,n))}function f(e,t,n,r){return e[1]&&r?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](r(t))):n.ctx}const h="undefined"!=typeof window;let d=h?()=>window.performance.now():()=>Date.now(),p=h?e=>requestAnimationFrame(e):e;const y=new Set;function v(e){y.forEach((t=>{t.c(e)||(y.delete(t),t.f())})),0!==y.size&&p(v)}const m="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;class g{_listeners="WeakMap"in m?new WeakMap:void 0;_observer=void 0;options;constructor(e){this.options=e}observe(e,t){return this._listeners.set(e,t),this._getObserver().observe(e,this.options),()=>{this._listeners.delete(e),this._observer.unobserve(e)}}_getObserver(){return this._observer??(this._observer=new ResizeObserver((e=>{for(const t of e)g.entries.set(t.target,t),this._listeners.get(t.target)?.(t)})))}}g.entries="WeakMap"in m?new WeakMap:void 0;let b=!1;function w(e,t){e.appendChild(t)}function _(e,t,n){const r=x(e);if(!r.getElementById(t)){const e=E("style");e.id=t,e.textContent=n,$(r,e)}}function x(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function k(e){const t=E("style");return t.textContent="/* empty */",$(x(e),t),t.sheet}function $(e,t){return w(e.head||e,t),t.sheet}function O(e,t,n){e.insertBefore(t,n||null)}function C(e){e.parentNode&&e.parentNode.removeChild(e)}function E(e){return document.createElement(e)}function P(e){return document.createTextNode(e)}function j(){return P(" ")}function S(){return P("")}function A(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function K(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function T(e,t,n){const r=t.toLowerCase();r in e?e[r]="boolean"==typeof e[r]&&""===n||n:t in e?e[t]="boolean"==typeof e[t]&&""===n||n:K(e,t,n)}function D(e,t){t=""+t,e.data!==t&&(e.data=t)}function I(e,t,n,r){null==n?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}function B(e,t){return new e(t)}const q=new Map;let R,M=0;function N(e,t){const n=(e.style.animation||"").split(", "),r=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),o=n.length-r.length;o&&(e.style.animation=r.join(", "),M-=o,M||p((()=>{M||(q.forEach((e=>{const{ownerNode:t}=e.stylesheet;t&&C(t)})),q.clear())})))}function F(e){R=e}const L=[],z=[];let U=[];const H=[],V=Promise.resolve();let W=!1;function Y(e){U.push(e)}const Q=new Set;let G,X=0;function J(){if(0!==X)return;const e=R;do{try{for(;X<L.length;){const e=L[X];X++,F(e),Z(e.$$)}}catch(e){throw L.length=0,X=0,e}for(F(null),L.length=0,X=0;z.length;)z.pop()();for(let e=0;e<U.length;e+=1){const t=U[e];Q.has(t)||(Q.add(t),t())}U.length=0}while(L.length);for(;H.length;)H.pop()();W=!1,Q.clear(),F(e)}function Z(e){if(null!==e.fragment){e.update(),i(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Y)}}function ee(e,t,n){e.dispatchEvent(function(e,t,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:r})}(`${t?"intro":"outro"}${n}`))}const te=new Set;let ne;function re(){ne={r:0,c:[],p:ne}}function oe(){ne.r||i(ne.c),ne=ne.p}function ie(e,t){e&&e.i&&(te.delete(e),e.i(t))}function ae(e,t,n,r){if(e&&e.o){if(te.has(e))return;te.add(e),ne.c.push((()=>{te.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}else r&&r()}const se={duration:0};function ue(n,r,o){const i={direction:"in"};let s,u,c=r(n,o,i),l=!1,f=0;function h(){s&&N(n,s)}function m(){const{delay:r=0,duration:o=300,easing:i=t,tick:a=e,css:m}=c||se;m&&(s=function(e,t,n,r,o,i,a,s=0){const u=16.666/r;let c="{\n";for(let e=0;e<=1;e+=u){const r=t+(n-t)*i(e);c+=100*e+`%{${a(r,1-r)}}\n`}const l=c+`100% {${a(n,1-n)}}\n}`,f=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(l)}_${s}`,h=x(e),{stylesheet:d,rules:p}=q.get(h)||function(e,t){const n={stylesheet:k(t),rules:{}};return q.set(e,n),n}(h,e);p[f]||(p[f]=!0,d.insertRule(`@keyframes ${f} ${l}`,d.cssRules.length));const y=e.style.animation||"";return e.style.animation=`${y?`${y}, `:""}${f} ${r}ms linear ${o}ms 1 both`,M+=1,f}(n,0,1,o,r,i,m,f++)),a(0,1);const g=d()+r,b=g+o;u&&u.abort(),l=!0,Y((()=>ee(n,!0,"start"))),u=function(e){let t;return 0===y.size&&p(v),{promise:new Promise((n=>{y.add(t={c:e,f:n})})),abort(){y.delete(t)}}}((e=>{if(l){if(e>=b)return a(1,0),ee(n,!0,"end"),h(),l=!1;if(e>=g){const t=i((e-g)/o);a(t,1-t)}}return l}))}let g=!1;return{start(){g||(g=!0,N(n),a(c)?(c=c(i),(G||(G=Promise.resolve(),G.then((()=>{G=null}))),G).then(m)):m())},invalidate(){g=!1},end(){l&&(h(),l=!1)}}}function ce(e){return void 0!==e?.length?e:Array.from(e)}function le(e,t){ae(e,1,1,(()=>{t.delete(e.key)}))}let fe;function he(e){e&&e.c()}function de(e,t,n){const{fragment:o,after_update:s}=e.$$;o&&o.m(t,n),Y((()=>{const t=e.$$.on_mount.map(r).filter(a);e.$$.on_destroy?e.$$.on_destroy.push(...t):i(t),e.$$.on_mount=[]})),s.forEach(Y)}function pe(e,t){const n=e.$$;null!==n.fragment&&(function(e){const t=[],n=[];U.forEach((r=>-1===e.indexOf(r)?t.push(r):n.push(r))),n.forEach((e=>e())),U=t}(n.after_update),i(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ye(t,n,r,a,s,u,c=null,l=[-1]){const f=R;F(t);const h=t.$$={fragment:null,ctx:[],props:u,update:e,not_equal:s,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(f?f.$$.context:[])),callbacks:o(),dirty:l,skip_bound:!1,root:n.target||f.$$.root};c&&c(h.root);let d=!1;if(h.ctx=r?r(t,n.props||{},((e,n,...r)=>{const o=r.length?r[0]:n;return h.ctx&&s(h.ctx[e],h.ctx[e]=o)&&(!h.skip_bound&&h.bound[e]&&h.bound[e](o),d&&function(e,t){-1===e.$$.dirty[0]&&(L.push(e),W||(W=!0,V.then(J)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(t,e)),n})):[],h.update(),d=!0,i(h.before_update),h.fragment=!!a&&a(h.ctx),n.target){if(n.hydrate){b=!0;const e=(p=n.target,Array.from(p.childNodes));h.fragment&&h.fragment.l(e),e.forEach(C)}else h.fragment&&h.fragment.c();n.intro&&ie(t.$$.fragment),de(t,n.target,n.anchor),b=!1,J()}var p;F(f)}function ve(e,t,n,r){const o=n[e]?.type;if(t="Boolean"===o&&"boolean"!=typeof t?null!=t:t,!r||!n[e])return t;if("toAttribute"===r)switch(o){case"Object":case"Array":return null==t?null:JSON.stringify(t);case"Boolean":return t?"":null;case"Number":return null==t?null:t;default:return t}else switch(o){case"Object":case"Array":return t&&JSON.parse(t);case"Boolean":default:return t;case"Number":return null!=t?+t:t}}function me(e,t,n,r,o,i){let a=class extends fe{constructor(){super(e,n,o),this.$$p_d=t}static get observedAttributes(){return Object.keys(t).map((e=>(t[e].attribute||e).toLowerCase()))}};return Object.keys(t).forEach((e=>{Object.defineProperty(a.prototype,e,{get(){return this.$$c&&e in this.$$c?this.$$c[e]:this.$$d[e]},set(n){n=ve(e,n,t),this.$$d[e]=n,this.$$c?.$set({[e]:n})}})})),r.forEach((e=>{Object.defineProperty(a.prototype,e,{get(){return this.$$c?.[e]}})})),i&&(a=i(a)),e.element=a,a}new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(fe=class extends HTMLElement{$$ctor;$$s;$$c;$$cn=!1;$$d={};$$r=!1;$$p_d={};$$l={};$$l_u=new Map;constructor(e,t,n){super(),this.$$ctor=e,this.$$s=t,n&&this.attachShadow({mode:"open"})}addEventListener(e,t,n){if(this.$$l[e]=this.$$l[e]||[],this.$$l[e].push(t),this.$$c){const n=this.$$c.$on(e,t);this.$$l_u.set(t,n)}super.addEventListener(e,t,n)}removeEventListener(e,t,n){if(super.removeEventListener(e,t,n),this.$$c){const e=this.$$l_u.get(t);e&&(e(),this.$$l_u.delete(t))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){if(await Promise.resolve(),!this.$$cn||this.$$c)return;function e(e){return()=>{let t;return{c:function(){t=E("slot"),"default"!==e&&K(t,"name",e)},m:function(e,n){O(e,t,n)},d:function(e){e&&C(t)}}}}const t={},n=function(e){const t={};return e.childNodes.forEach((e=>{t[e.slot||"default"]=!0})),t}(this);for(const o of this.$$s)o in n&&(t[o]=[e(o)]);for(const i of this.attributes){const a=this.$$g_p(i.name);a in this.$$d||(this.$$d[a]=ve(a,i.value,this.$$p_d,"toProp"))}for(const s in this.$$p_d)s in this.$$d||void 0===this[s]||(this.$$d[s]=this[s],delete this[s]);this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:t,$$scope:{ctx:[]}}});const r=()=>{this.$$r=!0;for(const e in this.$$p_d)if(this.$$d[e]=this.$$c.$$.ctx[this.$$c.$$.props[e]],this.$$p_d[e].reflect){const t=ve(e,this.$$d[e],this.$$p_d,"toAttribute");null==t?this.removeAttribute(this.$$p_d[e].attribute||e):this.setAttribute(this.$$p_d[e].attribute||e,t)}this.$$r=!1};this.$$c.$$.after_update.push(r),r();for(const u in this.$$l)for(const c of this.$$l[u]){const l=this.$$c.$on(u,c);this.$$l_u.set(c,l)}this.$$l={}}}attributeChangedCallback(e,t,n){this.$$r||(e=this.$$g_p(e),this.$$d[e]=ve(e,n,this.$$p_d,"toProp"),this.$$c?.$set({[e]:this.$$d[e]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then((()=>{this.$$cn||(this.$$c.$destroy(),this.$$c=void 0)}))}$$g_p(e){return Object.keys(this.$$p_d).find((t=>this.$$p_d[t].attribute===e||!this.$$p_d[t].attribute&&t.toLowerCase()===e))||e}});class ge{$$=void 0;$$set=void 0;$destroy(){pe(this,1),this.$destroy=e}$on(t,n){if(!a(n))return e;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const e=r.indexOf(n);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const be=[];function we(e,t){return{subscribe:_e(e,t).subscribe}}function _e(t,n=e){let r;const o=new Set;function i(e){if(s(t,e)&&(t=e,r)){const e=!be.length;for(const e of o)e[1](),be.push(e,t);if(e){for(let e=0;e<be.length;e+=2)be[e][0](be[e+1]);be.length=0}}}function a(e){i(e(t))}return{set:i,update:a,subscribe:function(s,u=e){const c=[s,u];return o.add(c),1===o.size&&(r=n(i,a)||e),s(t),()=>{o.delete(c),0===o.size&&r&&(r(),r=null)}}}}function xe(t,n,r){const o=!Array.isArray(t),s=o?[t]:t;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const c=n.length<2;return we(r,((t,r)=>{let l=!1;const f=[];let h=0,d=e;const p=()=>{if(h)return;d();const i=n(o?f[0]:f,t,r);c?t(i):d=a(i)?i:e},y=s.map(((e,t)=>u(e,(e=>{f[t]=e,h&=~(1<<t),l&&p()}),(()=>{h|=1<<t}))));return l=!0,p(),function(){i(y),d(),l=!1}}))}class ke{static config=new ke;autosave=!1;sessionSave=!0;autoload=!0;historyLimit=50;userNavigable=_e(!0);constructor(){}}const $e=ke.config;function Oe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pe.serializeHooks,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;switch(typeof e){case"string":case"number":case"boolean":return e;case"bigint":return{$:"b",v:"0x"+e.toString(16)};case"symbol":case"undefined":case"function":return;case"object":if(e instanceof Array)return e.map((e=>Oe(e,t)));if(e instanceof Map)return{$:"m",v:Array.of(e.entries()).map((e=>{let[n,r]=e;return[Oe(n,t),Oe(r,t)]}))};if(Object.hasOwn(e,"subscribe")){let n="r";return Object.hasOwn(e,"set")&&(n="w"),{$:n,v:Oe(c(e),t)}}{let r=Object.getPrototypeOf(e),o=t.get(r);if(o&&r!==n){let[n,i]=o;return{$:n,v:Oe(i(e),t,r)}}return{$:"o",v:Object.fromEntries(Object.entries(e).map((e=>{let[n,r]=e;return[n,Oe(r,t)]})))}}}}function Ce(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pe.deserializeHooks;switch(typeof e){case"string":case"number":case"boolean":return e;case"object":if(e instanceof Array)return e.map((e=>Ce(e,t)));let n=e.$;switch(n){case"r":return we(e.v);case"w":return _e(e.v);case"m":return new Map(e.v.map((e=>{let[n,r]=e;return[Ce(n,t),Ce(r,t)]})));case"o":return Object.fromEntries(Object.entries(e.v).map((e=>{let[n,r]=e;return[n,Ce(r,t)]})));case"b":return BigInt(e.v)}let r=t.get(n);return r?r(Ce(e.v,t)):void 0}}class Ee{static saveManager=new Ee;callbacks=[];serializeHooks=new Map;deserializeHooks=new Map;constructor(){}serializeData(){let e=[];for(let t of this.callbacks)e.push([t.tag,Oe(t.onSave(),this.serializeHooks)]);return JSON.stringify(Object.fromEntries(e))}loadData(e){let t=JSON.parse(e);for(let e of this.callbacks)e.onLoad(Ce(t[e.tag],this.deserializeHooks))}}const Pe=Ee.saveManager;var je=n(197);const Se=Symbol.for("Dexie"),Ae=globalThis[Se]||(globalThis[Se]=je);if(je.semVer!==Ae.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${je.semVer} and ${Ae.semVer}`);const{liveQuery:Ke,mergeRanges:Te,rangesOverlap:De,RangeSet:Ie,cmp:Be,Entity:qe,PropModSymbol:Re,PropModification:Me,replacePrefix:Ne}=Ae,Fe=Ae;class Le extends Fe{constructor(e){super(e),this.version(1).stores({saves:"slot, name, date"})}get(e){return this.saves.get(e)}getSaves(){return this.saves.toArray()}newSave(e){return this.transaction("rw",[this.saves],(async()=>{e.slot=(await this.saves.toArray()).map((e=>e.slot)).reduce(((e,t)=>Math.max(e,t)),-1)+1,await this.saves.add(e,e.slot)}))}removeAt(e){this.saves.delete(e)}}const ze=" theme";function Ue(e){document.documentElement.style.cssText=`--background-color: ${e.background}; --text-color: ${e.text}; --ui-primary-color: ${e.uiPrimary}; --ui-secondary-color: ${e.uiSecondary}; --link-color: ${e.link}; --link-visited-color: ${e.linkVisited};`}class He{constructor(e,t,n,r){this.name=e,this.tags=t,this.meta=n,this.component=r}}class Ve{constructor(e,t){this.passage=e,this.locals=t}}class We{constructor(e,t){this.moments=e,this.currentIndex=t}moments=[];currentIndex=0}class Ye{static engine=new Ye;_passages=[];_passagesByName=new Map;history=_e(new We([],0));loading=_e(!1);get locals(){let e=c(this.history);return e.moments[e.currentIndex].locals}globals={};constructor(){this.title=_e(document.title),this.staticTitle=document.title,this.saveDB=new Le(this.staticTitle),this.title.subscribe((e=>{document.title=e})),this.currentPassage=xe(this.history,(e=>this._passagesByName.get(e.moments[e.currentIndex].passage))),Pe.serializeHooks.set(We.prototype,["iff.engine.History",e=>e]),Pe.serializeHooks.set(Ve.prototype,["iff.engine.Moment",e=>e]),Pe.deserializeHooks.set("iff.engine.History",(e=>{let t=e;return new We(t.moments,t.currentIndex)})),Pe.deserializeHooks.set("iff.engine.Moment",(e=>{let t=e;return new Ve(t.passage,t.locals)})),Pe.callbacks.push({tag:"history",onSave:()=>c(this.history),onLoad:e=>{this.history.set(e)}}),Pe.callbacks.push({tag:"globals",onSave:()=>this.globals,onLoad:e=>{this.deleteGlobals();for(let[t,n]of Object.entries(e))this.globals[t]=n}})}deleteGlobals(){for(let e of Object.keys(this.globals))delete this.globals[e]}loadTheme=()=>function(e){let t=window.localStorage.getItem(e+ze);return null!==t?JSON.parse(t):null}(this.staticTitle);saveTheme=e=>{return t=this.staticTitle,n=e,void window.localStorage.setItem(t+ze,JSON.stringify(n));var t,n};applyTheme=Ue;saveSession(){if($e.sessionSave)try{let e=Pe.serializeData();2*e.length>=1e6?sessionStorage.removeItem(this.staticTitle+" save"):sessionStorage.setItem(this.staticTitle+" save",e)}catch(e){e instanceof DOMException&&e.code==DOMException.QUOTA_EXCEEDED_ERR&&sessionStorage.removeItem(this.staticTitle+" save")}}loadSave(e){this.loading.set(!0),e instanceof Promise?e.then((e=>{Pe.loadData(e.data)})).catch((e=>console.log("Error while loading: %o",e))).finally((()=>{this.loading.set(!1)})):(Pe.loadData(e.data),this.loading.set(!1))}initHistory(e){if($e.sessionSave){try{let t=sessionStorage.getItem(this.staticTitle+" save");t?Pe.loadData(t):this.history.set(e)}catch(t){this.history.set(e)}this.history.subscribe((()=>{this.saveSession()}))}else{if(sessionStorage.removeItem(this.staticTitle+" save"),$e.autoload)return this.loading.set(!0),void(async()=>{let t=await this.saveDB.get(-1);t?Pe.loadData(t.data):this.history.set(e),this.loading.set(!1)})();this.history.set(e)}}addPassages(e){this._passages=[...this._passages,...e];for(let t of e)this._passagesByName.set(t.name,t)}get passages(){return this._passages.values}passageAt(e){return this._passages[e]}passage(e){return this._passagesByName.get(e)}goTo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=c(this.history);for(n.moments=[new Ve(e.name,t),...n.moments.slice(n.currentIndex)];n.moments.length>$e.historyLimit;)n.moments.pop();n.currentIndex=0,this.history.set(n)}}const Qe=Ye.engine;function Ge(e){_(e,"svelte-co2bz2","a.svelte-co2bz2{color:var(--link-color)}a.svelte-co2bz2:visited{color:var(--link-visited-color)}")}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const Xe=e=>({}),Je=e=>({style:"color: inherit"});function Ze(e){let t,n,r,o,i;const a=e[4].default,s=function(e,t,n,r){if(e){const o=f(e,t,n,r);return e[0](o)}}(a,e,e[3],Je);return{c(){t=E("a"),s&&s.c(),K(t,"href",n=e[1]()),K(t,"class","svelte-co2bz2")},m(n,a){O(n,t,a),s&&s.m(t,null),r=!0,o||(i=A(t,"click",e[0]),o=!0)},p(e,t){let[n]=t;s&&s.p&&(!r||8&n)&&function(e,t,n,r,o,i){if(o){const a=f(t,n,r,i);e.p(a,o)}}(s,a,e,e[3],r?function(e,t,n,r){if(e[2]&&r){const o=e[2](r(n));if(void 0===t.dirty)return o;if("object"==typeof o){const e=[],n=Math.max(t.dirty.length,o.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|o[r];return e}return t.dirty|o}return t.dirty}(a,e[3],n,Xe):function(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}(e[3]),Je)},i(e){r||(ie(s,e),r=!0)},o(e){ae(s,e),r=!1},d(e){e&&C(t),s&&s.d(e),o=!1,i()}}}function et(e,t,n){let{$$slots:r={},$$scope:o}=t,{passage:i}=t;return e.$$set=e=>{"passage"in e&&n(2,i=e.passage),"$$scope"in e&&n(3,o=e.$$scope)},[e=>{Qe.goTo(Qe.passage(i))},()=>{let e=new URL(window.location.toString());return e.hash=i,e.toString()},i,o,r]}class tt extends ge{constructor(e){super(),ye(this,e,et,Ze,s,{passage:2},Ge)}get passage(){return this.$$.ctx[2]}set passage(e){this.$$set({passage:e}),J()}}me(tt,{passage:{}},["default"],[],!0);const nt=tt;class rt{static updater=new rt;_updateAvailable=_e(!1);constructor(){this.updateAvailable=this._updateAvailable,new BroadcastChannel("iff-update").onmessage=e=>{let t=e.data;"check"===t.type&&t.available&&this._updateAvailable.set(!0)}}async register(){let e=navigator.serviceWorker.controller;if(e){let t={type:"check"};e.postMessage(t)}else{let e,t=new URL("./config.json",window.location.href),n=await caches.open("iff-cache");try{e=await fetch(t,{cache:"no-cache"}),200==e.status&&(await n.put(t,e),navigator.serviceWorker.register(new URL("./service.js",window.location.href)))}catch{}}}}const ot=rt.updater;function it(e,{delay:n=0,duration:r=400,easing:o=t}={}){const i=+getComputedStyle(e).opacity;return{delay:n,duration:r,easing:o,css:e=>"opacity: "+e*i}}function at(e){_(e,"svelte-q9qyth",".container.svelte-q9qyth{border-radius:10px;background-color:rgb(151, 148, 101);padding:0.5em}")}function st(t){let n;return{c(){n=E("div"),n.textContent="Update available: reload the page to apply",K(n,"class","container svelte-q9qyth")},m(e,t){O(e,n,t)},p:e,i:e,o:e,d(e){e&&C(n)}}}function ut(e){return[]}BigInt(4294967295);class ct extends ge{constructor(e){super(),ye(this,e,ut,st,s,{},at)}}me(ct,{},[],[],!0);const lt=ct;function ft(e){_(e,"svelte-1cjpf5p","a.svelte-1cjpf5p{padding:0.5em;align-content:center;display:inline-block;user-select:none;font-size:1.5rem}")}function ht(e,t,n){const r=e.slice();return r[9]=t[n],r}function dt(e){let t,n,r;var o=e[9];return o&&(t=B(o,{})),{c(){t&&he(t.$$.fragment),n=S()},m(e,o){t&&de(t,e,o),O(e,n,o),r=!0},p(e,r){if(1&r&&o!==(o=e[9])){if(t){re();const e=t;ae(e.$$.fragment,1,0,(()=>{pe(e,1)})),oe()}o?(t=B(o,{}),he(t.$$.fragment),ie(t.$$.fragment,1),de(t,n.parentNode,n)):t=null}},i(e){r||(t&&ie(t.$$.fragment,e),r=!0)},o(e){t&&ae(t.$$.fragment,e),r=!1},d(e){e&&C(n),t&&pe(t,e)}}}function pt(e){let t,n,r,o,a,s,u,c,l,f,h,d,p,y=ce(e[0]),v=[];for(let t=0;t<y.length;t+=1)v[t]=dt(ht(e,y,t));const m=e=>ae(v[e],1,1,(()=>{v[e]=null}));return{c(){t=E("div"),n=E("h2"),r=P(e[1]),o=j(),a=E("div"),s=E("a"),u=P(""),c=E("a"),l=P(""),f=j();for(let e=0;e<v.length;e+=1)v[e].c();I(n,"border","1px solid var(--ui-primary-color)"),I(n,"border-right","0px"),I(n,"padding","0.5em"),I(n,"text-align","center"),I(n,"margin","0px"),I(s,"border","2px solid "+e[2]),I(s,"border-right","1px solid "+e[2]),I(s,"border-top","1px solid "+e[2]),I(s,"color",e[2]),K(s,"class","svelte-1cjpf5p"),I(c,"border","2px solid "+e[3]),I(c,"border-left","1px solid "+e[3]),I(c,"border-top","1px solid "+e[3]),I(c,"color",e[3]),K(c,"class","svelte-1cjpf5p"),I(t,"border-right","2px solid var(--ui-primary-color)"),I(t,"height","100%")},m(i,y){O(i,t,y),w(t,n),w(n,r),w(t,o),w(t,a),w(a,s),w(s,u),w(a,c),w(c,l),w(t,f);for(let e=0;e<v.length;e+=1)v[e]&&v[e].m(t,null);h=!0,d||(p=[A(s,"click",e[6]),A(c,"click",e[7])],d=!0)},p(e,n){let[o]=n;if((!h||2&o)&&D(r,e[1]),(!h||4&o)&&I(s,"border","2px solid "+e[2]),(!h||4&o)&&I(s,"border-right","1px solid "+e[2]),(!h||4&o)&&I(s,"border-top","1px solid "+e[2]),(!h||4&o)&&I(s,"color",e[2]),(!h||8&o)&&I(c,"border","2px solid "+e[3]),(!h||8&o)&&I(c,"border-left","1px solid "+e[3]),(!h||8&o)&&I(c,"border-top","1px solid "+e[3]),(!h||8&o)&&I(c,"color",e[3]),1&o){let n;for(y=ce(e[0]),n=0;n<y.length;n+=1){const r=ht(e,y,n);v[n]?(v[n].p(r,o),ie(v[n],1)):(v[n]=dt(r),v[n].c(),ie(v[n],1),v[n].m(t,null))}for(re(),n=y.length;n<v.length;n+=1)m(n);oe()}},i(e){if(!h){for(let e=0;e<y.length;e+=1)ie(v[e]);h=!0}},o(e){v=v.filter(Boolean);for(let e=0;e<v.length;e+=1)ae(v[e]);h=!1},d(e){e&&C(t),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(v,e),d=!1,i(p)}}}const yt=_e(!0);function vt(e,t,n){let r,o,i,{components:a}=t,s=xe([Qe.history,$e.userNavigable],(e=>{let[t,n]=e;return t.currentIndex>=t.moments.length-1||!n?"var(--ui-secondary-color)":"var(--ui-primary-color)"}));l(e,s,(e=>n(2,o=e)));let u=xe([Qe.history,$e.userNavigable],(e=>{let[t,n]=e;return 0!=t.currentIndex&&n?"var(--ui-primary-color)":"var(--ui-secondary-color)"}));l(e,u,(e=>n(3,i=e)));let f=Qe.title;return l(e,f,(e=>n(1,r=e))),e.$$set=e=>{"components"in e&&n(0,a=e.components)},[a,r,o,i,s,u,()=>{let e=c(Qe.history);e.currentIndex<e.moments.length-1&&c($e.userNavigable)&&(e.currentIndex+=1,Qe.history.set(e))},()=>{let e=c(Qe.history);e.currentIndex>0&&c($e.userNavigable)&&(e.currentIndex-=1,Qe.history.set(e))},f]}class mt extends ge{constructor(e){super(),ye(this,e,vt,pt,s,{components:0},ft)}get components(){return this.$$.ctx[0]}set components(e){this.$$set({components:e}),J()}}me(mt,{components:{}},[],[],!0);const gt=mt;function bt(t){let n;return{c(){n=E("div"),n.textContent="test"},m(e,t){O(e,n,t)},p:e,i:e,o:e,d(e){e&&C(n)}}}function wt(e){return[]}class _t extends ge{constructor(e){super(),ye(this,e,wt,bt,s,{})}}me(_t,{},[],[],!0);const xt=_t;function kt(e){_(e,"svelte-sp2oi5",".overlayContainer.svelte-sp2oi5{background-color:var(--ui-secondary-color);border-radius:20px;padding:1em}.overlayBackground.svelte-sp2oi5{display:flex;align-items:center;justify-content:center;width:100%;height:100%;padding:10vh 10vw;position:fixed;top:0px;left:0px;background-color:rgba(0, 0, 0, 0.4)}.content.svelte-sp2oi5{display:flex;flex-direction:row;height:100%}.passage.svelte-sp2oi5{padding:1em;box-sizing:border-box;flex:10}.main.svelte-sp2oi5{flex:5;display:flex;flex-direction:column;height:100%}.update.svelte-sp2oi5{z-index:100;position:absolute;right:1em;bottom:1em}")}function $t(e,t,n){const r=e.slice();return r[12]=t[n],r}function Ot(e){let t,n,r,o,i,a,s,u,c,l;r=new gt({props:{components:e[0]}});let f=e[1]&&Et(e);var h=e[4].component;h&&(u=B(h,{}));let d=e[2]&&Pt(e);return{c(){t=E("div"),n=E("div"),he(r.$$.fragment),o=j(),i=E("div"),f&&f.c(),a=j(),s=E("div"),u&&he(u.$$.fragment),c=j(),d&&d.c(),I(n,"flex","1"),K(s,"class","passage svelte-sp2oi5"),K(i,"class","main svelte-sp2oi5"),K(t,"class","content svelte-sp2oi5")},m(e,h){O(e,t,h),w(t,n),de(r,n,null),w(t,o),w(t,i),f&&f.m(i,null),w(i,a),w(i,s),u&&de(u,s,null),w(i,c),d&&d.m(i,null),l=!0},p(e,t){const n={};if(1&t&&(n.components=e[0]),r.$set(n),e[1]?f?(f.p(e,t),2&t&&ie(f,1)):(f=Et(e),f.c(),ie(f,1),f.m(i,a)):f&&(re(),ae(f,1,1,(()=>{f=null})),oe()),16&t&&h!==(h=e[4].component)){if(u){re();const e=u;ae(e.$$.fragment,1,0,(()=>{pe(e,1)})),oe()}h?(u=B(h,{}),he(u.$$.fragment),ie(u.$$.fragment,1),de(u,s,null)):u=null}e[2]?d?(d.p(e,t),4&t&&ie(d,1)):(d=Pt(e),d.c(),ie(d,1),d.m(i,null)):d&&(re(),ae(d,1,1,(()=>{d=null})),oe())},i(e){l||(ie(r.$$.fragment,e),ie(f),u&&ie(u.$$.fragment,e),ie(d),l=!0)},o(e){ae(r.$$.fragment,e),ae(f),u&&ae(u.$$.fragment,e),ae(d),l=!1},d(e){e&&C(t),pe(r),f&&f.d(),u&&pe(u),d&&d.d()}}}function Ct(t){let n;return{c(){n=E("div"),n.textContent="Loading",K(n,"class","content svelte-sp2oi5")},m(e,t){O(e,n,t)},p:e,i:e,o:e,d(e){e&&C(n)}}}function Et(e){let t,n,r;var o=e[1];return o&&(t=B(o,{})),{c(){t&&he(t.$$.fragment),n=S()},m(e,o){t&&de(t,e,o),O(e,n,o),r=!0},p(e,r){if(2&r&&o!==(o=e[1])){if(t){re();const e=t;ae(e.$$.fragment,1,0,(()=>{pe(e,1)})),oe()}o?(t=B(o,{}),he(t.$$.fragment),ie(t.$$.fragment,1),de(t,n.parentNode,n)):t=null}},i(e){r||(t&&ie(t.$$.fragment,e),r=!0)},o(e){t&&ae(t.$$.fragment,e),r=!1},d(e){e&&C(n),t&&pe(t,e)}}}function Pt(e){let t,n,r;var o=e[2];return o&&(t=B(o,{})),{c(){t&&he(t.$$.fragment),n=S()},m(e,o){t&&de(t,e,o),O(e,n,o),r=!0},p(e,r){if(4&r&&o!==(o=e[2])){if(t){re();const e=t;ae(e.$$.fragment,1,0,(()=>{pe(e,1)})),oe()}o?(t=B(o,{}),he(t.$$.fragment),ie(t.$$.fragment,1),de(t,n.parentNode,n)):t=null}},i(e){r||(t&&ie(t.$$.fragment,e),r=!0)},o(e){t&&ae(t.$$.fragment,e),r=!1},d(e){e&&C(n),t&&pe(t,e)}}}function jt(e){let t,n,r,o;return n=new lt({}),{c(){t=E("div"),he(n.$$.fragment),K(t,"class","update svelte-sp2oi5")},m(e,r){O(e,t,r),de(n,t,null),o=!0},i(e){o||(ie(n.$$.fragment,e),e&&(r||Y((()=>{r=ue(t,it,{duration:500}),r.start()}))),o=!0)},o(e){ae(n.$$.fragment,e),o=!1},d(e){e&&C(t),pe(n)}}}function St(e){let t,n,r=[],o=new Map,a=ce(e[6]);const s=e=>e[12];for(let t=0;t<a.length;t+=1){let n=$t(e,a,t),i=s(n);o.set(i,r[t]=At(i,n))}return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=S()},m(e,o){for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,o);O(e,t,o),n=!0},p(e,n){2112&n&&(a=ce(e[6]),re(),r=function(e,t,n,r,o,a,s,u,c,l,f,h){let d=e.length,p=a.length,y=d;const v={};for(;y--;)v[e[y].key]=y;const m=[],g=new Map,b=new Map,w=[];for(y=p;y--;){const e=h(o,a,y),r=n(e);let i=s.get(r);i?w.push((()=>i.p(e,t))):(i=l(r,e),i.c()),g.set(r,m[y]=i),r in v&&b.set(r,Math.abs(y-v[r]))}const _=new Set,x=new Set;function k(e){ie(e,1),e.m(u,f),s.set(e.key,e),f=e.first,p--}for(;d&&p;){const t=m[p-1],n=e[d-1],r=t.key,o=n.key;t===n?(f=t.first,d--,p--):g.has(o)?!s.has(r)||_.has(r)?k(t):x.has(o)?d--:b.get(r)>b.get(o)?(x.add(r),k(t)):(_.add(o),d--):(c(n,s),d--)}for(;d--;){const t=e[d];g.has(t.key)||c(t,s)}for(;p;)k(m[p-1]);return i(w),m}(r,n,s,0,e,a,o,t.parentNode,le,At,t,$t),oe())},i(e){if(!n){for(let e=0;e<a.length;e+=1)ie(r[e]);n=!0}},o(e){for(let e=0;e<r.length;e+=1)ae(r[e]);n=!1},d(e){e&&C(t);for(let t=0;t<r.length;t+=1)r[t].d(e)}}}function At(e,t){let n,r,o,i,a,s,u;var c=t[12].component;return c&&(o=B(c,{})),{key:e,first:null,c(){n=E("div"),r=E("div"),o&&he(o.$$.fragment),i=j(),K(r,"class","overlayContainer svelte-sp2oi5"),K(n,"class","overlayBackground svelte-sp2oi5"),this.first=n},m(e,c){var l;O(e,n,c),w(n,r),o&&de(o,r,null),w(n,i),a=!0,s||(u=A(n,"click",(l=t[11],function(e){e.target===this&&l.call(this,e)})),s=!0)},p(e,n){if(t=e,64&n&&c!==(c=t[12].component)){if(o){re();const e=o;ae(e.$$.fragment,1,0,(()=>{pe(e,1)})),oe()}c?(o=B(c,{}),he(o.$$.fragment),ie(o.$$.fragment,1),de(o,r,null)):o=null}},i(e){a||(o&&ie(o.$$.fragment,e),a=!0)},o(e){o&&ae(o.$$.fragment,e),a=!1},d(e){e&&C(n),o&&pe(o),s=!1,u()}}}function Kt(e){let t,n,r,o,i,a,s,u;const c=[Ct,Ot],l=[];function f(e,t){return e[3]?0:1}t=f(e),n=l[t]=c[t](e);let h=e[5]&&jt(),d=0!=e[6].length&&St(e);return{c(){n.c(),r=j(),h&&h.c(),o=j(),d&&d.c(),i=S()},m(n,c){l[t].m(n,c),O(n,r,c),h&&h.m(n,c),O(n,o,c),d&&d.m(n,c),O(n,i,c),a=!0,s||(u=A(window,"keydown",e[10]),s=!0)},p(e,a){let[s]=a,u=t;t=f(e),t===u?l[t].p(e,s):(re(),ae(l[u],1,1,(()=>{l[u]=null})),oe(),n=l[t],n?n.p(e,s):(n=l[t]=c[t](e),n.c()),ie(n,1),n.m(r.parentNode,r)),e[5]?h?32&s&&ie(h,1):(h=jt(),h.c(),ie(h,1),h.m(o.parentNode,o)):h&&(re(),ae(h,1,1,(()=>{h=null})),oe()),0!=e[6].length?d?(d.p(e,s),64&s&&ie(d,1)):(d=St(e),d.c(),ie(d,1),d.m(i.parentNode,i)):d&&(re(),ae(d,1,1,(()=>{d=null})),oe())},i(e){a||(ie(n),ie(h),ie(d),a=!0)},o(e){ae(n),ae(h),ae(d),a=!1},d(e){e&&(C(r),C(o),C(i)),l[t].d(e),h&&h.d(e),d&&d.d(e),s=!1,u()}}}const Tt=_e([]);function Dt(t,n,r){let o,i,a,s,u=e;l(t,Tt,(e=>r(6,s=e))),t.$$.on_destroy.push((()=>u()));let{sidebarComponents:f}=n,{header:h}=n,{footer:d}=n;const p=Qe.currentPassage;l(t,p,(e=>r(4,i=e)));const y=ot.updateAvailable;l(t,y,(e=>r(5,a=e)));const v=Qe.loading;function m(){Tt.set([...c(Tt).slice(0,-1)])}return l(t,v,(e=>r(3,o=e))),t.$$set=e=>{"sidebarComponents"in e&&r(0,f=e.sidebarComponents),"header"in e&&r(1,h=e.header),"footer"in e&&r(2,d=e.footer)},[f,h,d,o,i,a,s,p,y,v,function(e){e.ctrlKey&&"s"==e.key.toLowerCase()&&(e.preventDefault(),c(yt)&&(c(Tt).find((e=>e.component===xt))?Tt.set(c(Tt).filter((e=>e.component!==xt))):Tt.set([...c(Tt),{component:xt,dismissible:!0}]))),"Escape"===e.key&&0!=c(Tt).length&&m()},m]}class It extends ge{constructor(e){super(),ye(this,e,Dt,Kt,s,{sidebarComponents:0,header:1,footer:2},kt)}get sidebarComponents(){return this.$$.ctx[0]}set sidebarComponents(e){this.$$set({sidebarComponents:e}),J()}get header(){return this.$$.ctx[1]}set header(e){this.$$set({header:e}),J()}get footer(){return this.$$.ctx[2]}set footer(e){this.$$set({footer:e}),J()}}me(It,{sidebarComponents:{},header:{},footer:{}},[],[],!0);const Bt=It;function qt(){let e=Qe.globals;return e.hasCloak??=!0,e.room??=_e(""),e.lastRoom??="",e}function Rt(e){let t=qt();t.lastRoom=c(t.room),t.room.set(e)}function Mt(e){_(e,"svelte-sjii8g","a.svelte-sjii8g{color:var(--link-color)}")}function Nt(t){let n;return{c(){n=E("p"),n.innerHTML='The bar, much rougher than you&#39;d have guessed after the opulence of the foyer to the north, is completely empty.\n        There seems to be some sort of <iff-link passage="message">message</iff-link> scrawled in the sawdust on the floor.'},m(e,t){O(e,n,t)},p:e,d(e){e&&C(n)}}}function Ft(e){let t,n,r,o,i=0==e[0]&&Lt(e),a=1==e[0]&&zt(e),s=2==e[0]&&Ut(e),u=3==e[0]&&Ht(e);return{c(){t=E("p"),i&&i.c(),n=j(),a&&a.c(),r=j(),s&&s.c(),o=j(),u&&u.c()},m(e,c){O(e,t,c),i&&i.m(t,null),w(t,n),a&&a.m(t,null),w(t,r),s&&s.m(t,null),w(t,o),u&&u.m(t,null)},p(e,c){0==e[0]?i?i.p(e,c):(i=Lt(e),i.c(),i.m(t,n)):i&&(i.d(1),i=null),1==e[0]?a?a.p(e,c):(a=zt(e),a.c(),a.m(t,r)):a&&(a.d(1),a=null),2==e[0]?s?s.p(e,c):(s=Ut(e),s.c(),s.m(t,o)):s&&(s.d(1),s=null),3==e[0]?u?u.p(e,c):(u=Ht(e),u.c(),u.m(t,null)):u&&(u.d(1),u=null)},d(e){e&&C(t),i&&i.d(),a&&a.d(),s&&s.d(),u&&u.d()}}}function Lt(t){let n,r,o,a,s,u,c,l,f,h,d;return{c(){n=P("You can't see a thing! Not even the door you entered by--was it "),r=E("a"),r.textContent="north",o=P(",\n            "),a=E("a"),a.textContent="south",s=P(", "),u=E("a"),u.textContent="east",c=P(" or "),l=E("a"),l.textContent="west",f=P("?"),K(r,"class","svelte-sjii8g"),K(a,"class","svelte-sjii8g"),K(u,"class","svelte-sjii8g"),K(l,"class","svelte-sjii8g")},m(e,i){O(e,n,i),O(e,r,i),O(e,o,i),O(e,a,i),O(e,s,i),O(e,u,i),O(e,c,i),O(e,l,i),O(e,f,i),h||(d=[A(r,"click",t[3]),A(a,"click",t[2]),A(u,"click",t[2]),A(l,"click",t[2])],h=!0)},p:e,d(e){e&&(C(n),C(r),C(o),C(a),C(s),C(u),C(c),C(l),C(f)),h=!1,i(d)}}}function zt(t){let n,r,o,a,s,u,c,l,f,h,d,p,y,v,m;return{c(){n=P("Blundering around in the dark isn't a good idea!\n            You can't tell "),r=E("a"),r.textContent="left",o=P(" from "),a=E("a"),a.textContent="right",s=P(",\n            let alone "),u=E("a"),u.textContent="east",c=P(" from "),l=E("a"),l.textContent="west",f=P(" or "),h=E("a"),h.textContent="north",d=P(" from "),p=E("a"),p.textContent="south",y=P("."),K(r,"class","svelte-sjii8g"),K(a,"class","svelte-sjii8g"),K(u,"class","svelte-sjii8g"),K(l,"class","svelte-sjii8g"),K(h,"class","svelte-sjii8g"),K(p,"class","svelte-sjii8g")},m(e,i){O(e,n,i),O(e,r,i),O(e,o,i),O(e,a,i),O(e,s,i),O(e,u,i),O(e,c,i),O(e,l,i),O(e,f,i),O(e,h,i),O(e,d,i),O(e,p,i),O(e,y,i),v||(m=[A(r,"click",t[2]),A(a,"click",t[2]),A(u,"click",t[2]),A(l,"click",t[2]),A(h,"click",t[3]),A(p,"click",t[2])],v=!0)},p:e,d(e){e&&(C(n),C(r),C(o),C(a),C(s),C(u),C(c),C(l),C(f),C(h),C(d),C(p),C(y)),v=!1,i(m)}}}function Ut(t){let n,r,o,a,s,u,c,l,f;return{c(){n=P("No, this isn't getting you anywhere... Let's see, the door was "),r=E("a"),r.textContent="south",o=P(", wasn't it?\n            So the exit must be "),a=E("a"),a.textContent="north",s=P(", unless you've gotten "),u=E("a"),u.textContent="turned around",c=P("."),K(r,"class","svelte-sjii8g"),K(a,"class","svelte-sjii8g"),K(u,"class","svelte-sjii8g")},m(e,i){O(e,n,i),O(e,r,i),O(e,o,i),O(e,a,i),O(e,s,i),O(e,u,i),O(e,c,i),l||(f=[A(r,"click",t[2]),A(a,"click",t[3]),A(u,"click",t[2])],l=!0)},p:e,d(e){e&&(C(n),C(r),C(o),C(a),C(s),C(u),C(c)),l=!1,i(f)}}}function Ht(t){let n,r,o,i,a;return{c(){n=P("Oops, this is just a blank wall! But perhaps if you "),r=E("a"),r.textContent="follow it around",o=P("..."),K(r,"class","svelte-sjii8g")},m(e,s){O(e,n,s),O(e,r,s),O(e,o,s),i||(a=A(r,"click",t[3]),i=!0)},p:e,d(e){e&&(C(n),C(r),C(o)),i=!1,a()}}}function Vt(t){let n,r=function(e,t){return e[1].hasCloak?Ft:Nt}(t),o=r(t);return{c(){o.c(),n=S()},m(e,t){o.m(e,t),O(e,n,t)},p(e,t){let[n]=t;o.p(e,n)},i:e,o:e,d(e){e&&C(n),o.d(e)}}}function Wt(e,t,n){let r=0,o=qt();return o.hasCloak?Rt("Darkness"):Rt("Bar"),[r,o,function(){n(0,r+=1)},function(){Qe.goTo(Qe.passage("foyer"))}]}class Yt extends ge{constructor(e){super(),ye(this,e,Wt,Vt,s,{},Mt)}}me(Yt,{},[],[],!0);const Qt=Yt;function Gt(e){_(e,"svelte-sjii8g","a.svelte-sjii8g{color:var(--link-color)}")}function Xt(t){let n,r,o,i,a;return{c(){n=E("p"),n.textContent="A handsome cloak, of velvet trimmed with satin, and slightly spattered with raindrops.\n    Its blackness is so deep that it almost seems to suck light from the room.",r=j(),o=E("a"),o.textContent="Back",K(o,"class","svelte-sjii8g")},m(e,s){O(e,n,s),O(e,r,s),O(e,o,s),i||(a=A(o,"click",t[0]),i=!0)},p:e,i:e,o:e,d(e){e&&(C(n),C(r),C(o)),i=!1,a()}}}function Jt(e){return Rt("Cloak"),[function(){Qe.history.set(new We(c(Qe.history).moments.slice(1),0))}]}class Zt extends ge{constructor(e){super(),ye(this,e,Jt,Xt,s,{},Gt)}}me(Zt,{},[],[],!0);const en=Zt;function tn(t){let n,r,o,i,a=!t[0].hasCloak&&function(e){let t;return{c(){t=E("p"),t.innerHTML='It holds your <iff-link passage="cloak">Cloak</iff-link>.'},m(e,n){O(e,t,n)},d(e){e&&C(t)}}}();return{c(){n=E("p"),n.innerHTML='The walls of this small room were clearly once lined with hooks,\n    though now <iff-link passage="cloakroomhook">only one remains</iff-link>.',r=j(),a&&a.c(),o=j(),i=E("p"),i.innerHTML='The exit is a door to the <iff-link passage="foyer">east</iff-link>.'},m(e,t){O(e,n,t),O(e,r,t),a&&a.m(e,t),O(e,o,t),O(e,i,t)},p:e,i:e,o:e,d(e){e&&(C(n),C(r),C(o),C(i)),a&&a.d(e)}}}function nn(e){let t=qt();return Rt("Cloakroom"),[t]}class rn extends ge{constructor(e){super(),ye(this,e,nn,tn,s,{})}}me(rn,{},[],[],!0);const on=rn;function an(e){_(e,"svelte-sjii8g","a.svelte-sjii8g{color:var(--link-color)}")}function sn(t){let n,r,o,i,a,s,u,c;return{c(){n=E("p"),r=P("You could "),o=E("a"),o.textContent="pick up your cloak and wear it",i=P(", if you like,\n        or simply turn back to the "),a=E("iff-link"),a.textContent="Cloakroom",s=P("."),K(o,"class","svelte-sjii8g"),T(a,"passage","cloakroom")},m(e,l){O(e,n,l),w(n,r),w(n,o),w(n,i),w(n,a),w(n,s),u||(c=A(o,"click",t[1]),u=!0)},p:e,d(e){e&&C(n),u=!1,c()}}}function un(t){let n,r,o,i,a,s,u,c;return{c(){n=E("p"),r=P("You could "),o=E("a"),o.textContent="hang",i=P(" your "),a=E("iff-link"),a.textContent="Cloak",s=P(" here."),K(o,"class","svelte-sjii8g"),T(a,"passage","cloak")},m(e,l){O(e,n,l),w(n,r),w(n,o),w(n,i),w(n,a),w(n,s),u||(c=A(o,"click",t[2]),u=!0)},p:e,d(e){e&&C(n),u=!1,c()}}}function cn(t){let n,r,o;function i(e,t){return e[0].hasCloak?un:sn}let a=i(t),s=a(t);return{c(){n=E("p"),n.textContent="It's just a small brass hook, screwed to the wall.",r=j(),s.c(),o=S()},m(e,t){O(e,n,t),O(e,r,t),s.m(e,t),O(e,o,t)},p(e,t){let[n]=t;a===(a=i(e))&&s?s.p(e,n):(s.d(1),s=a(e),s&&(s.c(),s.m(o.parentNode,o)))},i:e,o:e,d(e){e&&(C(n),C(r),C(o)),s.d(e)}}}function ln(e,t,n){let r=qt();return Rt("Cloakroom"),[r,function(){n(0,r.hasCloak=!0,r)},function(){n(0,r.hasCloak=!1,r)}]}class fn extends ge{constructor(e){super(),ye(this,e,ln,cn,s,{},an)}}me(fn,{},[],[],!0);const hn=fn;function dn(e){let t;return{c(){t=P("cloak")},m(e,n){O(e,t,n)},d(e){e&&C(t)}}}function pn(t){let n,r,o,i="Outside"==t[0].lastRoom&&t[0].hasCloak&&function(e){let t,n,r,o,i;return r=new nt({props:{passage:"cloak",$$slots:{default:[dn]},$$scope:{ctx:e}}}),{c(){t=E("p"),n=P("Shaking the rain from your "),he(r.$$.fragment),o=P(", you step gratefully inside.")},m(e,a){O(e,t,a),w(t,n),de(r,t,null),w(t,o),i=!0},i(e){i||(ie(r.$$.fragment,e),i=!0)},o(e){ae(r.$$.fragment,e),i=!1},d(e){e&&C(t),pe(r)}}}(t);return{c(){i&&i.c(),n=j(),r=E("p"),r.innerHTML='You are standing in a spacious hall, splendidly decorated in red and gold, with glittering chandeliers overhead.\n    The entrance from the street is to the <iff-link passage="outside">north</iff-link>, and there are doorways <iff-link passage="bar">south</iff-link> and <iff-link passage="cloakroom">west</iff-link>.'},m(e,t){i&&i.m(e,t),O(e,n,t),O(e,r,t),o=!0},p:e,i(e){o||(ie(i),o=!0)},o(e){ae(i),o=!1},d(e){e&&(C(n),C(r)),i&&i.d(e)}}}function yn(e){let t=qt();return Rt("Foyer"),[t]}class vn extends ge{constructor(e){super(),ye(this,e,yn,pn,s,{})}}me(vn,{},[],[],!0);const mn=vn;function gn(t){let n;return{c(){n=E("div")},m(e,t){O(e,n,t),n.innerHTML="<p>The message, neatly marked in the sawdust, reads...</p><br><p><em>You have won</em></p><br>"},p:e,i:e,o:e,d(e){e&&C(n)}}}function bn(e){let t;return{c(){t=P("Opera House")},m(e,n){O(e,t,n)},d(e){e&&C(t)}}}function wn(e){let t,n,r,o,i;return r=new nt({props:{passage:"foyer",$$slots:{default:[bn]},$$scope:{ctx:e}}}),{c(){t=E("p"),n=P("Hurrying through the rainswept November night, you're glad to see the bright lights of the "),he(r.$$.fragment),o=P(".\n    It's surprising that there aren't more people about but, hey, what do you expect in a cheap demo game...?")},m(e,a){O(e,t,a),w(t,n),de(r,t,null),w(t,o),i=!0},p(e,t){let[n]=t;const o={};1&n&&(o.$$scope={dirty:n,ctx:e}),r.$set(o)},i(e){i||(ie(r.$$.fragment,e),i=!0)},o(e){ae(r.$$.fragment,e),i=!1},d(e){e&&C(t),pe(r)}}}function _n(e){return Rt("Outside"),[]}class xn extends ge{constructor(e){super(),ye(this,e,_n,wn,s,{})}}me(xn,{},[],[],!0);const kn=xn;function $n(t){let n;return{c(){n=E("div")},m(e,t){O(e,n,t),n.innerHTML='<div style="display: flex; align-items: center; justify-content: center; flex-direction: column; width: 100%;"><br><br><h1>Cloak of Darkness</h1><br><img src="./image.png" alt="A Chandelier" style="max-width: 60%;"><br><br><p><em>based on work by Iain Merrick</em><br><em>photo by Alessia Cocconi</em></p><br><p><iff-link passage="outside">Begin</iff-link></p><br></div>'},p:e,i:e,o:e,d(e){e&&C(n)}}}const On=[new He("bar",[],{},Qt),new He("cloak",[],{},en),new He("cloakroom",[],{},on),new He("cloakroomhook",[],{},hn),new He("foyer",[],{},mn),new He("message",[],{},class extends ge{constructor(e){super(),ye(this,e,null,gn,s,{})}}),new He("outside",[],{},kn),new He("start",[],{},class extends ge{constructor(e){super(),ye(this,e,null,$n,s,{})}})];function Cn(e){_(e,"svelte-18ahaie",".container.svelte-18ahaie{display:flex;align-items:center;justify-content:center;width:100%;padding:2em;box-sizing:border-box;border-bottom:1px solid var(--ui-primary-color)}")}function En(e){let t,n,r;return{c(){t=E("div"),n=E("span"),r=P(e[0]),K(t,"class","container svelte-18ahaie")},m(e,o){O(e,t,o),w(t,n),w(n,r)},p(e,t){1&t&&D(r,e[0])},d(e){e&&C(t)}}}function Pn(t){let n,r=""!==t[0]&&En(t);return{c(){r&&r.c(),n=S()},m(e,t){r&&r.m(e,t),O(e,n,t)},p(e,t){let[o]=t;""!==e[0]?r?r.p(e,o):(r=En(e),r.c(),r.m(n.parentNode,n)):r&&(r.d(1),r=null)},i:e,o:e,d(e){e&&C(n),r&&r.d(e)}}}function jn(e,t,n){let r,o=qt().room;return l(e,o,(e=>n(0,r=e))),[r,o]}class Sn extends ge{constructor(e){super(),ye(this,e,jn,Pn,s,{},Cn)}}me(Sn,{},[],[],!0);const An=Sn;function Kn(e){_(e,"svelte-fg1zvu","a.svelte-fg1zvu{display:block;border:1px solid var(--ui-primary-color);border-right:0px;box-sizing:border-box;padding:1em}")}function Tn(t){let n,r,o;return{c(){n=E("a"),n.textContent="Restart",K(n,"class","svelte-fg1zvu")},m(e,i){O(e,n,i),r||(o=A(n,"click",t[0]),r=!0)},p:e,i:e,o:e,d(e){e&&C(n),r=!1,o()}}}function Dn(e){return[function(){let e=qt();e.room.set(""),e.lastRoom="",e.hasCloak=!0,Qe.history.set(new We([new Ve("start",{})],0))}]}class In extends ge{constructor(e){super(),ye(this,e,Dn,Tn,s,{},Kn)}}me(In,{},[],[],!0);const Bn=In;let qn=()=>{$e.historyLimit=2,$e.userNavigable.set(!1),Qe.addPassages(On),Qe.initHistory(new We([new Ve("start",{})],0)),customElements.define("iff-link",nt.element),document.getElementById("iff-noscript-container")?.remove(),new Bt({target:document.body,props:{sidebarComponents:[Bn],header:An,footer:null}}),ot.register().catch((e=>console.log(e)))};"loading"==document.readyState?window.addEventListener("DOMContentLoaded",qn):qn()})()})();